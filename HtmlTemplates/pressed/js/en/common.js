"document"in self&&("classList"in document.createElement("_")?!function(){var a=document.createElement("_");if(a.classList.add("c1","c2"),!a.classList.contains("c2")){var b=function(a){var b=DOMTokenList.prototype[a];DOMTokenList.prototype[a]=function(a){var c,d=arguments.length;for(c=0;d>c;c++)a=arguments[c],b.call(this,a)}};b("add"),b("remove")}if(a.classList.toggle("c3",!1),a.classList.contains("c3")){var c=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(a,b){return 1 in arguments&&!this.contains(a)==!b?b:c.call(this,a)}}a=null}():!function(a){"use strict";if("Element"in a){var b="classList",c="prototype",d=a.Element[c],e=Object,f=String[c].trim||function(){return this.replace(/^\s+|\s+$/g,"")},g=Array[c].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},h=function(a,b){this.name=a,this.code=DOMException[a],this.message=b},i=function(a,b){if(""===b)throw new h("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(b))throw new h("INVALID_CHARACTER_ERR","String contains an invalid character");return g.call(a,b)},j=function(a){for(var b=f.call(a.getAttribute("class")||""),c=b?b.split(/\s+/):[],d=0,e=c.length;e>d;d++)this.push(c[d]);this._updateClassName=function(){a.setAttribute("class",this.toString())}},k=j[c]=[],l=function(){return new j(this)};if(h[c]=Error[c],k.item=function(a){return this[a]||null},k.contains=function(a){return a+="",-1!==i(this,a)},k.add=function(){var a,b=arguments,c=0,d=b.length,e=!1;do a=b[c]+"",-1===i(this,a)&&(this.push(a),e=!0);while(++c<d);e&&this._updateClassName()},k.remove=function(){var a,b,c=arguments,d=0,e=c.length,f=!1;do for(a=c[d]+"",b=i(this,a);-1!==b;)this.splice(b,1),f=!0,b=i(this,a);while(++d<e);f&&this._updateClassName()},k.toggle=function(a,b){a+="";var c=this.contains(a),d=c?b!==!0&&"remove":b!==!1&&"add";return d&&this[d](a),b===!0||b===!1?b:!c},k.toString=function(){return this.join(" ")},e.defineProperty){var m={get:l,enumerable:!0,configurable:!0};try{e.defineProperty(d,b,m)}catch(n){-2146823252===n.number&&(m.enumerable=!1,e.defineProperty(d,b,m))}}else e[c].__defineGetter__&&d.__defineGetter__(b,l)}}(self));var app={el:document.getElementsByTagName("body")[0],popupSurround:document.body.querySelector(".body_popup-surround"),popup:document.body.querySelector(".body_popup"),module:{},ext:{},ui:{},register:function(a,b,c){this[a][b]=c()},start:function(a){var b;for(b in a)a.hasOwnProperty(b)&&void 0!==this[b][a[b]].init&&this[b][a[b]].init()},bindEvents:function(){app.ext.pubsub.addListener("popup-surround:show",app.ext.tools.bind(this,this.showPopupSurround)),app.ext.pubsub.addListener("popup-surround:hide",app.ext.tools.bind(this,this.hidePopupSurround))},showPopupSurround:function(){this.popupSurround.style.display="block",this.popup.style.display="block";var a=this;setTimeout(function(){a.popupSurround.style.opacity=.7,a.popup.style.opacity=1},50),this.el.style.overflow="hidden",document.documentElement.style.paddingRight=app.ext.tools.scrollBarWidth+"px"},hidePopupSurround:function(){this.popupSurround.style.opacity=0,this.popup.style.opacity=0;var a=this;setTimeout(function(){a.popupSurround.style.display="",a.popup.style.display="",a.el.style.overflow="",document.documentElement.style.paddingRight=0},500)}};app.mcc={"742-":1,"742+":2,"763-":3,"763+":2,"780-":1,"780+":2,"1520-":4,"1520+":2,"1711-":1,"1711+":2,"1731-":1,"1731+":2,"1740-":1,"1740+":2,"1750-":1,"1750+":2,"1761-":1,"1761+":2,"1771-":1,"1771+":2,"1799-":3,"1799+":2,"2741-":5,"2741+":2,"2791-":3,"2791+":2,"2842-":1,"2842+":2,"3000-":6,"3000+":2,"3001-":6,"3001+":2,"3002-":6,"3002+":2,"3003-":6,"3003+":2,"3004-":6,"3004+":2,"3005-":6,"3005+":2,"3006-":6,"3006+":2,"3007-":6,"3007+":2,"3008-":6,"3008+":2,"3009-":6,"3009+":2,"3010-":6,"3010+":2,"3011-":6,"3011+":2,"3012-":6,"3012+":2,"3013-":6,"3013+":2,"3014-":6,"3014+":2,"3015-":6,"3015+":2,"3016-":6,"3016+":2,"3017-":6,"3017+":2,"3018-":6,"3018+":2,"3019-":6,"3019+":2,"3020-":6,"3020+":2,"3021-":6,"3021+":2,"3022-":6,"3022+":2,"3023-":6,"3023+":2,"3024-":6,"3024+":2,"3025-":6,"3025+":2,"3026-":6,"3026+":2,"3027-":6,"3027+":2,"3028-":6,"3028+":2,"3029-":6,"3029+":2,"3030-":6,"3030+":2,"3031-":6,"3031+":2,"3032-":6,"3032+":2,"3033-":6,"3033+":2,"3034-":6,"3034+":2,"3035-":6,"3035+":2,"3036-":6,"3036+":2,"3037-":6,"3037+":2,"3038-":6,"3038+":2,"3039-":6,"3039+":2,"3040-":6,"3040+":2,"3041-":6,"3041+":2,"3042-":6,"3042+":2,"3043-":6,"3043+":2,"3044-":6,"3044+":2,"3045-":6,"3045+":2,"3046-":6,"3046+":2,"3047-":6,"3047+":2,"3048-":6,"3048+":2,"3049-":6,"3049+":2,"3050-":6,"3050+":2,"3051-":6,"3051+":2,"3052-":6,"3052+":2,"3053-":6,"3053+":2,"3054-":6,"3054+":2,"3055-":6,"3055+":2,"3056-":6,"3056+":2,"3057-":6,"3057+":2,"3058-":6,"3058+":2,"3059-":6,"3059+":2,"3060-":6,"3060+":2,"3061-":6,"3061+":2,"3062-":6,"3062+":2,"3063-":6,"3063+":2,"3064-":6,"3064+":2,"3065-":6,"3065+":2,"3066-":6,"3066+":2,"3067-":6,"3067+":2,"3071-":6,"3071+":2,"3075-":6,"3075+":2,"3076-":6,"3076+":2,"3077-":6,"3077+":2,"3078-":6,"3078+":2,"3079-":6,"3079+":2,"3081-":6,"3081+":2,"3082-":6,"3082+":2,"3083-":6,"3083+":2,"3084-":6,"3084+":2,"3085-":6,"3085+":2,"3086-":6,"3086+":2,"3087-":6,"3087+":2,"3088-":6,"3088+":2,"3089-":6,"3089+":2,"3090-":6,"3090+":2,"3092-":6,"3092+":2,"3094-":6,"3094+":2,"3095-":6,"3095+":2,"3096-":6,"3096+":2,"3097-":6,"3097+":2,"3098-":6,"3098+":2,"3099-":6,"3099+":2,"3100-":6,"3100+":2,"3102-":6,"3102+":2,"3103-":6,"3103+":2,"3106-":6,"3106+":2,"3110-":6,"3110+":2,"3111-":6,"3111+":2,"3112-":6,"3112+":2,"3115-":6,"3115+":2,"3117-":6,"3117+":2,"3118-":6,"3118+":2,"3125-":6,"3125+":2,"3126-":6,"3126+":2,"3127-":6,"3127+":2,"3129-":6,"3129+":2,"3130-":6,"3130+":2,"3131-":6,"3131+":2,"3132-":6,"3132+":2,"3133-":6,"3133+":2,"3135-":6,"3135+":2,"3136-":6,"3136+":2,"3137-":6,"3137+":2,"3138-":6,"3138+":2,"3143-":6,"3143+":2,"3144-":6,"3144+":2,"3145-":6,"3145+":2,"3146-":6,"3146+":2,"3148-":6,"3148+":2,"3151-":6,"3151+":2,"3154-":6,"3154+":2,"3156-":6,"3156+":2,"3159-":6,"3159+":2,"3161-":6,"3161+":2,"3164-":6,"3164+":2,"3165-":6,"3165+":2,"3167-":6,"3167+":2,"3170-":6,"3170+":2,"3171-":6,"3171+":2,"3172-":6,"3172+":2,"3174-":6,"3174+":2,"3175-":6,"3175+":2,"3176-":6,"3176+":2,"3177-":6,"3177+":2,"3178-":6,"3178+":2,"3180-":6,"3180+":2,"3181-":6,"3181+":2,"3182-":6,"3182+":2,"3183-":6,"3183+":2,"3184-":6,"3184+":2,"3185-":6,"3185+":2,"3186-":6,"3186+":2,"3187-":6,"3187+":2,"3188-":6,"3188+":2,"3190-":6,"3190+":2,"3191-":6,"3191+":2,"3192-":6,"3192+":2,"3193-":6,"3193+":2,"3196-":6,"3196+":2,"3197-":6,"3197+":2,"3200-":6,"3200+":2,"3203-":6,"3203+":2,"3204-":6,"3204+":2,"3206-":6,"3206+":2,"3211-":6,"3211+":2,"3212-":6,"3212+":2,"3213-":6,"3213+":2,"3215-":6,"3215+":2,"3216-":6,"3216+":2,"3217-":6,"3217+":2,"3218-":6,"3218+":2,"3219-":6,"3219+":2,"3220-":6,"3220+":2,"3221-":6,"3221+":2,"3222-":6,"3222+":2,"3223-":6,"3223+":2,"3226-":6,"3226+":2,"3228-":6,"3228+":2,"3229-":6,"3229+":2,"3231-":6,"3231+":2,"3233-":6,"3233+":2,"3234-":6,"3234+":2,"3235-":6,"3235+":2,"3236-":6,"3236+":2,"3238-":6,"3238+":2,"3239-":6,"3239+":2,"3240-":6,"3240+":2,"3241-":6,"3241+":2,"3242-":6,"3242+":2,"3243-":6,"3243+":2,"3245-":6,"3245+":2,"3246-":6,"3246+":2,"3247-":6,"3247+":2,"3248-":6,"3248+":2,"3251-":6,"3251+":2,"3252-":6,"3252+":2,"3253-":6,"3253+":2,"3254-":6,"3254+":2,"3256-":6,"3256+":2,"3259-":6,"3259+":2,"3260-":6,"3260+":2,"3261-":6,"3261+":2,"3262-":6,"3262+":2,"3263-":6,"3263+":2,"3266-":6,"3266+":2,"3267-":6,"3267+":2,"3280-":6,"3280+":2,"3282-":6,"3282+":2,"3284-":6,"3284+":2,"3285-":6,"3285+":2,"3286-":6,"3286+":2,"3287-":6,"3287+":2,"3292-":6,"3292+":2,"3293-":6,"3293+":2,"3294-":6,"3294+":2,"3295-":6,"3295+":2,"3296-":6,"3296+":2,"3297-":6,"3297+":2,"3298-":6,"3298+":2,"3299-":6,"3299+":2,"3351-":7,"3351+":2,"3352-":7,"3352+":2,"3353-":7,"3353+":2,"3354-":7,"3354+":2,"3355-":7,"3355+":2,"3357-":7,"3357+":2,"3359-":7,"3359+":2,"3360-":7,"3360+":2,"3361-":7,"3361+":2,"3362-":7,"3362+":2,"3364-":7,"3364+":2,"3366-":7,"3366+":2,"3368-":7,"3368+":2,"3370-":7,"3370+":2,"3374-":7,"3374+":2,"3376-":7,"3376+":2,"3380-":7,"3380+":2,"3381-":7,"3381+":2,"3385-":7,"3385+":2,"3386-":7,"3386+":2,"3387-":7,"3387+":2,"3388-":7,"3388+":2,"3389-":7,"3389+":2,"3390-":7,"3390+":2,"3391-":7,"3391+":2,"3393-":7,"3393+":2,"3394-":7,"3394+":2,"3395-":7,"3395+":2,"3396-":7,"3396+":2,"3398-":7,"3398+":2,"3400-":7,"3400+":2,"3405-":7,"3405+":2,"3409-":7,"3409+":2,"3412-":7,"3412+":2,"3414-":7,"3414+":2,"3420-":7,"3420+":2,"3421-":7,"3421+":2,"3423-":7,"3423+":2,"3425-":7,"3425+":2,"3427-":7,"3427+":2,"3428-":7,"3428+":2,"3429-":7,"3429+":2,"3430-":7,"3430+":2,"3431-":7,"3431+":2,"3432-":7,"3432+":2,"3433-":7,"3433+":2,"3434-":7,"3434+":2,"3435-":7,"3435+":2,"3436-":7,"3436+":2,"3437-":7,"3437+":2,"3438-":7,"3438+":2,"3439-":7,"3439+":2,"3441-":7,"3441+":2,"3501-":6,"3501+":2,"3502-":6,"3502+":2,"3503-":6,"3503+":2,"3504-":6,"3504+":2,"3505-":6,"3505+":2,"3506-":6,"3506+":2,"3507-":6,"3507+":2,"3508-":6,"3508+":2,"3509-":6,"3509+":2,"3510-":6,"3510+":2,"3511-":6,"3511+":2,"3512-":6,"3512+":2,"3513-":6,"3513+":2,"3514-":6,"3514+":2,"3515-":6,"3515+":2,"3516-":6,"3516+":2,"3517-":6,"3517+":2,"3518-":6,"3518+":2,"3519-":6,"3519+":2,"3520-":6,"3520+":2,"3521-":6,"3521+":2,"3522-":6,"3522+":2,"3523-":6,"3523+":2,"3524-":6,"3524+":2,"3525-":6,"3525+":2,"3526-":6,"3526+":2,"3527-":6,"3527+":2,"3528-":6,"3528+":2,"3529-":6,"3529+":2,"3530-":6,"3530+":2,"3531-":6,"3531+":2,"3532-":6,"3532+":2,"3533-":6,"3533+":2,"3534-":6,"3534+":2,"3535-":6,"3535+":2,"3536-":6,"3536+":2,"3537-":6,"3537+":2,"3538-":6,"3538+":2,"3539-":6,"3539+":2,"3540-":6,"3540+":2,"3541-":6,"3541+":2,"3542-":6,"3542+":2,"3543-":6,"3543+":2,"3544-":6,"3544+":2,"3545-":6,"3545+":2,"3546-":6,"3546+":2,"3548-":6,"3548+":2,"3549-":6,"3549+":2,"3550-":6,"3550+":2,"3551-":6,"3551+":2,"3552-":6,"3552+":2,"3553-":6,"3553+":2,"3554-":6,"3554+":2,"3555-":6,"3555+":2,"3556-":6,"3556+":2,"3557-":6,"3557+":2,"3558-":6,"3558+":2,"3559-":6,"3559+":2,"3560-":6,"3560+":2,"3561-":6,"3561+":2,"3562-":6,"3562+":2,"3563-":6,"3563+":2,"3564-":6,"3564+":2,"3565-":6,"3565+":2,"3566-":6,"3566+":2,"3567-":6,"3567+":2,"3568-":6,"3568+":2,"3569-":6,"3569+":2,"3570-":6,"3570+":2,"3571-":6,"3571+":2,"3572-":6,"3572+":2,"3573-":6,"3573+":2,"3574-":6,"3574+":2,"3575-":6,"3575+":2,"3576-":6,"3576+":2,"3577-":6,"3577+":2,"3578-":6,"3578+":2,"3579-":6,"3579+":2,"3580-":6,"3580+":2,"3581-":6,"3581+":2,"3582-":6,"3582+":2,"3583-":6,"3583+":2,"3584-":6,"3584+":2,"3585-":6,"3585+":2,"3586-":6,"3586+":2,"3587-":6,"3587+":2,"3588-":6,"3588+":2,"3589-":6,"3589+":2,"3590-":6,"3590+":2,"3591-":6,"3591+":2,"3592-":6,"3592+":2,"3593-":6,"3593+":2,"3594-":6,"3594+":2,"3595-":6,"3595+":2,"3596-":6,"3596+":2,"3597-":6,"3597+":2,"3598-":6,"3598+":2,"3599-":6,"3599+":2,"3603-":6,"3603+":2,"3608-":6,"3608+":2,"3609-":6,"3609+":2,"3612-":6,"3612+":2,"3613-":6,"3613+":2,"3614-":6,"3614+":2,"3615-":6,"3615+":2,"3617-":6,"3617+":2,"3618-":6,"3618+":2,"3619-":6,"3619+":2,"3620-":6,"3620+":2,"3621-":6,"3621+":2,"3622-":6,"3622+":2,"3623-":6,"3623+":2,"3624-":6,"3624+":2,"3625-":6,"3625+":2,"3626-":6,"3626+":2,"3627-":6,"3627+":2,"3628-":6,"3628+":2,"3629-":6,"3629+":2,"3630-":6,"3630+":2,"3631-":6,"3631+":2,"3632-":6,"3632+":2,"3633-":6,"3633+":2,"3634-":6,"3634+":2,"3635-":6,"3635+":2,"3636-":6,"3636+":2,"3637-":6,"3637+":2,"3638-":6,"3638+":2,"3639-":6,"3639+":2,"3640-":6,"3640+":2,"3641-":6,"3641+":2,"3642-":6,"3642+":2,"3643-":6,"3643+":2,"3644-":6,"3644+":2,"3645-":6,"3645+":2,"3646-":6,"3646+":2,"3647-":6,"3647+":2,"3648-":6,"3648+":2,"3649-":6,"3649+":2,"3650-":6,"3650+":2,"3651-":6,"3651+":2,"3652-":6,"3652+":2,"3653-":6,"3653+":2,"3654-":6,"3654+":2,"3655-":6,"3655+":2,"3656-":6,"3656+":2,"3657-":6,"3657+":2,"3658-":6,"3658+":2,"3659-":6,"3659+":2,"3660-":6,"3660+":2,"3661-":6,"3661+":2,"3662-":6,"3662+":2,"3663-":6,"3663+":2,"3664-":6,"3664+":2,"3665-":6,"3665+":2,"3666-":6,"3666+":2,"3667-":6,"3667+":2,"3668-":6,"3668+":2,"3669-":6,"3669+":2,"3670-":6,"3670+":2,"3671-":6,"3671+":2,"3672-":6,"3672+":2,"3673-":6,"3673+":2,"3674-":6,"3674+":2,"3675-":6,"3675+":2,"3676-":6,"3676+":2,"3677-":6,"3677+":2,"3678-":6,"3678+":2,"3679-":6,"3679+":2,"3680-":6,"3680+":2,"3681-":6,"3681+":2,"3682-":6,"3682+":2,"3683-":6,"3683+":2,"3684-":6,"3684+":2,"3685-":6,"3685+":2,"3686-":6,"3686+":2,"3687-":6,"3687+":2,"3688-":6,"3688+":2,"3689-":6,"3689+":2,"3690-":6,"3690+":2,"3691-":6,"3691+":2,"3692-":6,"3692+":2,"3693-":6,"3693+":2,"3694-":6,"3694+":2,"3695-":6,"3695+":2,"3696-":6,"3696+":2,"3697-":6,"3697+":2,"3698-":6,"3698+":2,"3699-":6,"3699+":2,"3700-":6,"3700+":2,"3701-":6,"3701+":2,"3702-":6,"3702+":2,"3703-":6,"3703+":2,"3704-":6,"3704+":2,"3705-":6,"3705+":2,"3706-":6,"3706+":2,"3707-":6,"3707+":2,"3708-":6,"3708+":2,"3709-":6,"3709+":2,"3710-":6,"3710+":2,"3711-":6,"3711+":2,"3712-":6,"3712+":2,"3713-":6,"3713+":2,"3714-":6,"3714+":2,"3715-":6,"3715+":2,"3716-":6,"3716+":2,"3717-":6,"3717+":2,"3718-":6,"3718+":2,"3719-":6,"3719+":2,"3720-":6,"3720+":2,"3721-":6,"3721+":2,"3722-":6,"3722+":2,"3723-":6,"3723+":2,"3724-":6,"3724+":2,"3725-":6,"3725+":2,"3726-":6,"3726+":2,"3727-":6,"3727+":2,"3728-":6,"3728+":2,"3729-":6,"3729+":2,"3730-":6,"3730+":2,"3731-":6,"3731+":2,"3732-":6,"3732+":2,"3733-":6,"3733+":2,"3734-":6,"3734+":2,"3735-":6,"3735+":2,"3736-":6,"3736+":2,"3737-":6,"3737+":2,"3738-":6,"3738+":2,"3739-":6,"3739+":2,"3740-":6,"3740+":2,"3741-":6,"3741+":2,"3742-":6,"3742+":2,"3743-":6,"3743+":2,"3744-":6,"3744+":2,"3745-":6,"3745+":2,"3746-":6,"3746+":2,"3747-":6,"3747+":2,"3748-":6,"3748+":2,"3749-":6,"3749+":2,"3750-":6,"3750+":2,"3751-":6,"3751+":2,"3752-":6,"3752+":2,"3753-":6,"3753+":2,"3754-":6,"3754+":2,"3755-":6,"3755+":2,"3756-":6,"3756+":2,"3757-":6,"3757+":2,"3758-":6,"3758+":2,"3759-":6,"3759+":2,"3760-":6,"3760+":2,"3761-":6,"3761+":2,"3762-":6,"3762+":2,"3763-":6,"3763+":2,"3764-":6,"3764+":2,"3765-":6,"3765+":2,"3766-":6,"3766+":2,"3767-":6,"3767+":2,"3768-":6,"3768+":2,"3769-":6,"3769+":2,"3770-":6,"3770+":2,"3771-":6,"3771+":2,"3772-":6,"3772+":2,"3773-":6,"3773+":2,"3774-":6,"3774+":2,"3775-":6,"3775+":2,"3776-":6,"3776+":2,"3777-":6,"3777+":2,"3778-":6,"3778+":2,"3779-":6,"3779+":2,"3780-":6,"3780+":2,"3781-":6,"3781+":2,"3782-":6,"3782+":2,"3783-":6,"3783+":2,"3784-":6,"3784+":2,"3785-":6,"3785+":2,"3786-":6,"3786+":2,"3787-":6,"3787+":2,"3788-":6,"3788+":2,"3789-":6,"3789+":2,"3790-":6,"3790+":2,"3791-":6,"3791+":2,"3792-":6,"3792+":2,"3793-":6,"3793+":2,"3794-":6,"3794+":2,"3795-":6,"3795+":2,"3796-":6,"3796+":2,"3797-":6,"3797+":2,"3798-":6,"3798+":2,"3799-":6,"3799+":2,"3800-":6,"3800+":2,"3807-":6,"3807+":2,"3809-":6,"3809+":2,"3826-":6,"3826+":2,"3827-":6,"3827+":2,"4011-":6,"4011+":2,"4111-":8,"4111+":2,"4112-":6,"4112+":2,"4119-":9,"4119+":2,"4121-":5,"4121+":2,"4131-":8,"4131+":2,"4214-":3,"4214+":2,"4215-":3,"4215+":2,"4225-":3,"4225+":2,"4411-":6,"4411+":2,"4457-":5,"4457+":2,"4468-":3,"4468+":2,"4511-":6,"4511+":2,"4582-":6,"4582+":2,"4722-":6,"4722+":2,"4723-":6,"4723+":2,"4784-":3,"4784+":2,"4789-":8,"4789+":2,"4812-":1,"4812+":2,"4813-":4,"4813+":2,"4814-":4,"4814+":2,"4815-":4,"4815+":2,"4816-":4,"4816+":2,"4821-":4,"4821+":2,"4829-":10,"4829+":11,"4899-":4,"4899+":2,"4900-":4,"4900+":2,"5013-":7,"5013+":2,"5021-":3,"5021+":2,"5038-":3,"5038+":2,"5039-":1,"5039+":2,"5044-":3,"5044+":2,"5045-":1,"5045+":2,"5046-":3,"5046+":2,"5047-":9,"5047+":2,"5051-":3,"5051+":2,"5065-":3,"5065+":2,"5072-":3,"5072+":2,"5074-":4,"5074+":2,"5085-":3,"5085+":2,"5094-":12,"5094+":2,"5099-":3,"5099+":2,"5111-":3,"5111+":2,"5122-":9,"5122+":2,"5131-":12,"5131+":2,"5137-":12,"5137+":2,"5139-":12,"5139+":2,"5169-":1,"5169+":2,"5172-":7,"5172+":2,"5192-":5,"5192+":2,"5193-":1,"5193+":2,"5198-":1,"5198+":2,"5199-":1,"5199+":2,"5200-":1,"5200+":2,"5211-":1,"5211+":2,"5231-":1,"5231+":2,"5251-":3,"5251+":2,"5261-":1,"5261+":2,"5271-":4,"5271+":2,"5300-":3,"5300+":2,"5309-":12,"5309+":2,"5310-":12,"5310+":2,"5311-":12,"5311+":2,"5331-":13,"5331+":2,"5399-":3,"5399+":2,"5411-":13,"5411+":2,"5422-":13,"5422+":2,"5441-":13,"5441+":2,"5451-":13,"5451+":2,"5462-":13,"5462+":2,"5499-":13,"5499+":2,"5511-":7,"5511+":2,"5521-":7,"5521+":2,"5531-":1,"5531+":2,"5532-":7,"5532+":2,"5533-":7,"5533+":2,"5541-":7,"5541+":2,"5542-":7,"5542+":2,"5551-":5,"5551+":2,"5561-":3,"5561+":2,"5571-":5,"5571+":2,"5592-":6,"5592+":2,"5598-":5,"5598+":2,"5599-":3,"5599+":2,"5611-":12,"5611+":2,"5621-":12,"5621+":2,"5631-":12,"5631+":2,"5641-":12,"5641+":2,"5651-":12,"5651+":2,"5655-":12,"5655+":2,"5661-":12,"5661+":2,"5681-":12,"5681+":2,"5691-":12,"5691+":2,"5697-":12,"5697+":2,"5698-":12,"5698+":2,"5699-":12,"5699+":2,"5712-":3,"5712+":2,"5713-":1,"5713+":2,"5714-":1,"5714+":2,"5718-":1,"5718+":2,"5719-":1,"5719+":2,"5722-":1,"5722+":2,"5732-":1,"5732+":2,"5733-":5,"5733+":2,"5734-":1,"5734+":2,"5735-":5,"5735+":2,"5811-":3,"5811+":2,"5812-":14,"5812+":2,"5813-":14,"5813+":2,"5814-":14,"5814+":2,"5912-":9,"5912+":2,"5921-":13,"5921+":2,"5931-":12,"5931+":2,"5932-":15,"5932+":2,"5933-":3,"5933+":2,"5935-":3,"5935+":2,"5937-":15,"5937+":2,"5940-":5,"5940+":2,"5941-":5,"5941+":2,"5942-":5,"5942+":2,"5943-":3,"5943+":2,"5944-":12,"5944+":2,"5945-":5,"5945+":2,"5946-":1,"5946+":2,"5947-":3,"5947+":2,"5948-":12,"5948+":2,"5949-":3,"5949+":2,"5950-":1,"5950+":2,"5960-":3,"5960+":2,"5962-":6,"5962+":2,"5963-":3,"5963+":2,"5964-":3,"5964+":2,"5965-":3,"5965+":2,"5966-":3,"5966+":2,"5967-":3,"5967+":2,"5968-":3,"5968+":2,"5969-":3,"5969+":2,"5970-":15,"5970+":2,"5971-":15,"5971+":2,"5972-":15,"5972+":2,"5973-":3,"5973+":2,"5975-":9,"5975+":2,"5976-":9,"5976+":2,"5977-":9,"5977+":2,"5978-":3,"5978+":2,"5983-":7,"5983+":2,"5992-":1,"5992+":2,"5993-":13,"5993+":2,"5994-":5,"5994+":2,"5995-":1,"5995+":2,"5996-":1,"5996+":2,"5997-":1,"5997+":2,"5998-":5,"5998+":2,"5999-":5,"5999+":2,"6010-":16,"6010+":17,"6011-":16,"6011+":17,"6012-":10,"6012+":11,"6022-":3,"6022+":2,"6023-":3,"6023+":2,"6025-":3,"6025+":2,"6026-":3,"6026+":2,"6028-":3,"6028+":2,"6050-":16,"6050+":17,"6051-":3,"6051+":2,"6211-":3,"6211+":2,"6300-":3,"6300+":2,"6381-":3,"6381+":2,"6399-":3,"6399+":2,"6513-":1,"6513+":2,"6529-":3,"6529+":2,"6530-":3,"6530+":2,"6531-":3,"6531+":2,"6532-":10,"6532+":11,"6533-":3,"6533+":2,"6534-":3,"6534+":2,"6535-":3,"6535+":2,"6536-":10,"6536+":11,"6537-":10,"6537+":11,"7011-":6,"7011+":2,"7012-":3,"7012+":2,"7032-":5,"7032+":2,"7033-":5,"7033+":2,"7210-":12,"7210+":2,"7211-":1,"7211+":2,"7216-":12,"7216+":2,"7217-":1,"7217+":2,"7221-":5,"7221+":2,"7230-":9,"7230+":2,"7251-":12,"7251+":2,"7261-":3,"7261+":2,"7273-":5,"7273+":2,"7276-":3,"7276+":2,"7277-":1,"7277+":2,"7278-":3,"7278+":2,"7296-":12,"7296+":2,"7297-":9,"7297+":2,"7298-":9,"7298+":2,"7299-":4,"7299+":2,"7311-":3,"7311+":2,"7321-":3,"7321+":2,"7332-":3,"7332+":2,"7333-":15,"7333+":2,"7338-":3,"7338+":2,"7339-":3,"7339+":2,"7342-":3,"7342+":2,"7349-":1,"7349+":2,"7361-":3,"7361+":2,"7372-":3,"7372+":2,"7375-":3,"7375+":2,"7379-":1,"7379+":2,"7392-":1,"7392+":2,"7393-":7,"7393+":2,"7394-":3,"7394+":2,"7395-":5,"7395+":2,"7399-":3,"7399+":2,"7511-":3,"7511+":2,"7512-":7,"7512+":2,"7513-":3,"7513+":2,"7519-":6,"7519+":2,"7523-":7,"7523+":2,"7531-":7,"7531+":2,"7534-":7,"7534+":2,"7535-":7,"7535+":2,"7538-":7,"7538+":2,"7542-":7,"7542+":2,"7549-":7,"7549+":2,"7622-":1,"7622+":2,"7623-":1,"7623+":2,"7629-":3,"7629+":2,"7631-":12,"7631+":2,"7641-":1,"7641+":2,"7692-":1,"7692+":2,"7699-":1,"7699+":2,"7829-":5,"7829+":2,"7832-":5,"7832+":2,"7841-":5,"7841+":2,"7911-":18,"7911+":2,"7922-":5,"7922+":2,"7929-":3,"7929+":2,"7932-":5,"7932+":2,"7933-":5,"7933+":2,"7941-":5,"7941+":2,"7991-":5,"7991+":2,"7992-":5,"7992+":2,"7993-":5,"7993+":2,"7994-":5,"7994+":2,"7995-":5,"7995+":2,"7996-":5,"7996+":2,"7997-":5,"7997+":2,"7998-":5,"7998+":2,"7999-":5,"7999+":2,"8011-":9,"8011+":2,"8021-":9,"8021+":2,"8031-":9,"8031+":2,"8041-":9,"8041+":2,"8042-":9,"8042+":2,"8043-":9,"8043+":2,"8044-":3,"8044+":2,"8049-":9,"8049+":2,"8050-":6,"8050+":2,"8062-":9,"8062+":2,"8071-":9,"8071+":2,"8099-":9,"8099+":2,"8111-":3,"8111+":2,"8211-":18,"8211+":2,"8220-":18,"8220+":2,"8241-":18,"8241+":2,"8244-":18,"8244+":2,"8249-":18,"8249+":2,"8299-":18,"8299+":2,"8351-":1,"8351+":2,"8398-":3,"8398+":2,"8641-":3,"8641+":2,"8651-":3,"8651+":2,"8661-":3,"8661+":2,"8675-":7,"8675+":2,"8699-":3,"8699+":2,"8734-":3,"8734+":2,"8911-":1,"8911+":2,"8931-":3,"8931+":2,"8999-":3,"8999+":2,"9211-":3,"9211+":2,"9222-":3,"9222+":2,"9223-":3,"9223+":2,"9311-":3,"9311+":2,"9399-":3,"9399+":2,"9401-":3,"9401+":2,"9402-":3,"9402+":2,"9405-":3,"9405+":2,"9700-":3,"9700+":2,"9701-":3,"9701+":2,"9702-":3,"9702+":2,"9751-":13,"9751+":2,"9752-":7,"9752+":2,"9950-":3,"9950+":2,"9990-":16,"9990+":17,"9991-":3,"9991+":2,"9994-":3,"9994+":2,"9995-":10,"9995+":11,"9996-":16,"9996+":17,"9997-":16,"9997+":17,"9998-":10,"9998+":11,"9999-":3,"9999+":2,"99991000-":3,"99991000+":2,"99991010-":3,"99991010+":2,"99991030-":3,"99991030+":2,"99991040-":3,"99991040+":2,"99991050-":3,"99991050+":2,"99991060-":3,"99991060+":2,"99991100-":3,"99991100+":2,"99991110-":3,"99991110+":2,"99991120-":3,"99991120+":2,"99991130-":3,"99991130+":2,"99991140-":3,"99991140+":2,"99991200-":3,"99991200+":2,"99991210-":3,"99991210+":2,"99991220-":3,"99991220+":2,"99991230-":3,"99991230+":2,"99991310-":3,"99991310+":2,"99991410-":3,"99991410+":2,"99991510-":3,"99991510+":2,"99992000-":16,"99992000+":17,"99992001-":16,"99992001+":17,"99992010-":16,"99992010+":17,"99992011-":16,"99992011+":17,"99992020-":16,"99992020+":17,"99992021-":16,"99992021+":17,"99992100-":16,"99992100+":17,"99992110-":16,"99992110+":17,"99992200-":16,"99992200+":17,"99992210-":16,"99992210+":17,"99992320-":10,"99992320+":2,"99992321-":10,"99992321+":2,"99992322-":10,"99992322+":2,"99992323-":10,"99992323+":2,"99992325-":10,"99992325+":2,"99992330-":10,"99992330+":2,"99992331-":10,"99992331+":2,"99992332-":10,"99992332+":2,"99992340-":10,"99992340+":2,"99992341-":10,"99992341+":2,"99992342-":10,"99992342+":2,"99992350-":19,"99992350+":2,"99992351-":19,"99992351+":2,"99992352-":19,"99992352+":2,"99992353-":19,"99992353+":2,"99992354-":19,"99992354+":2,"99992360-":8,"99992360+":2,"99992370-":10,"99992370+":2,"99992371-":10,"99992371+":2,"99992400-":20,"99992400+":2,"99992401-":20,"99992401+":2,"99992402-":20,"99992402+":2,"99992403-":20,"99992403+":2,"99992410-":10,"99992410+":2,"99992411-":10,"99992411+":2,"99992412-":10,"99992412+":2,"99992413-":10,"99992413+":2,"99992420-":10,"99992420+":2,"99992421-":10,"99992421+":2,"99992422-":10,"99992422+":2,"99992423-":10,"99992423+":2,"99992430-":10,"99992430+":2,"99992431-":10,"99992431+":2,"99992432-":10,"99992432+":2,"99992433-":10,"99992433+":2,"99992440-":10,"99992440+":2,"99992450-":10,"99992450+":2,"99992900-":16,"99992900+":17,"99992901-":10,"99992901+":2,"99992990-":10,"99992990+":2,"99992992-":10,"99992992+":2,"99993001-":21,"99993001+":2,"99993030-":21,"99993030+":2,"99993120-":21,"99993120+":2,"99993200-":21,"99993200+":2,"99993210-":21,"99993210+":2,"99993300-":21,"99993300+":2,"99993800-":21,"99993800+":2,"99993810-":21,"99993810+":2,"99993900-":21,"99993900+":2,"99994000-":21,"99994000+":2,"99994001-":21,"99994001+":2,"99994010-":21,"99994010+":2,"99994011-":21,"99994011+":2,"99994020-":21,"99994020+":2,"99994021-":21,"99994021+":2,"99994030-":21,"99994030+":2,"99994031-":21,"99994031+":2,"99994040-":21,"99994040+":2,"99994041-":21,"99994041+":2,"99994050-":21,"99994050+":2,"99994051-":21,"99994051+":2,"99994052-":21,"99994052+":2,"99994060-":21,"99994060+":2,"99994061-":21,"99994061+":2,"99994062-":21,"99994062+":2,"99994071-":21,"99994071+":2,"99994080-":21,"99994080+":2,"99994081-":21,"99994081+":2,"99994082-":21,"99994082+":2,"99994083-":21,"99994083+":2,"99994090-":21,"99994090+":2,"99994095-":21,"99994095+":2,"99994100-":21,"99994100+":2,"99994110-":21,"99994110+":2,"99994200-":21,"99994200+":2,"99994210-":21,"99994210+":2,"99994400-":21,"99994400+":2,"99994440-":21,"99994440+":2,"99994500-":21,"99994500+":2,"99994600-":21,"99994600+":2,"99995110-":21,"99995110+":2,"99995120-":21,"99995120+":2,"99996000-":3,"99996000+":2,"99996010-":3,"99996010+":2,"99996100-":3,"99996100+":2,"99996110-":3,"99996110+":2,"99996200-":3,"99996200+":2,"99996210-":3,"99996210+":2,"99997000-":3,"99997000+":22,"99997010-":16,"99997010+":17,"99997011-":16,"99997011+":17,"99997014-":16,"99997014+":17,"99997015-":16,"99997015+":17,"99997020-":16,"99997020+":17,"99997021-":16,"99997021+":17,"99997024-":16,"99997024+":17,"99997025-":16,"99997025+":17,"99997030-":3,"99997030+":11,"99997031-":3,"99997031+":11,"99997032-":3,"99997032+":11,"99997034-":3,"99997034+":11,"99997035-":3,"99997035+":11,"99997040-":3,"99997040+":11,"99997041-":3,"99997041+":11,"99997042-":3,"99997042+":11,"99997044-":3,"99997044+":11,"99997045-":3,"99997045+":11,"99997050-":3,"99997050+":22,"99997060-":3,"99997060+":22,"99997064-":3,"99997064+":23,"99997070-":3,"99997070+":11,"99997071-":3,"99997071+":11,"99997074+":2,"99997074-":10,"99997075+":2,"99997075-":10,"99997080-":3,"99997080+":24,"99997081-":3,"99997081+":24,"99997082-":3,"99997082+":24,"99997083-":3,"99997083+":24,"99997090-":3,"99997090+":22,"99997091-":3,"99997091+":22,"99997100-":3,"99997100+":22,"99997101-":3,"99997101+":22,"99998000-":3,"99998000+":22,"99998001-":3,"99998001+":23,"99998002-":3,"99998002+":23,"99998003-":3,"99998003+":2,"99998035-":3,"99998035+":2,"99998050-":10,"99998050+":2,"99998100-":3,"99998100+":2,"99998140-":3,"99998140+":2,"99998145-":3,"99998145+":2,"99998146-":3,"99998146+":2,"99998150-":3,"99998150+":2,"99998151-":3,"99998151+":23,"99998210-":21,"99998210+":2,"99998220-":21,"99998220+":2,"99998230-":21,"99998230+":2},app.catColors={1:"#a6daf6",2:"#cfea86",3:"#d1deec",4:"#ffbc6e",5:"#9cdbc3",6:"#fdbee0",7:"#ff9292",8:"#c7c7f3",9:"#eeb6ff",10:"#b9cff4",11:"#7cce9f",12:"#a6c0d4",13:"#f5d967",14:"#ffada2",15:"#daba74",16:"#b2df90",17:"#9cdb8d",18:"#b3d5ad",19:"#d1deec",20:"#b9cff4",21:"#cbddcf",22:"#87e1c0",23:"#7fd3ca",24:"#7cce9f",25:"#d2d5bc",26:"#f68d4d"},app.categories={1:"Homeware",2:"Returns, cancel operations",3:"Other expenses",4:"Utilities, mobile, internet",5:"Entertainment",6:"Travelling",7:"Car",8:"Transport",9:"Health and beauty",10:"Transfer from card",11:"Transfer to card",12:"Clothes and accessories",13:"Supermarkets",14:"Cafes and restaurants",15:"Art",16:"Сash payment",17:"Cash",18:"Education",19:"Loan payments",20:"Transfer to deposit",21:"Fees",22:"Enrollment",23:"Other supply",24:"Transfer from deposit",25:"Other incomes"},app.countries={AUS:["Australia","AU","36"],AUT:["Austria","AT","40"],AZE:["Azerbaijan","AZ","31"],ALA:["Aland Islands","AX","248"],ALB:["Albania","AL","8"],DZA:["Algeria","DZ","12"],VIR:["Virgin Islands (USA)","VI","850"],ASM:["American Samoa","AS","16"],AIA:["Anguilla","AI","660"],AGO:["Angola","AO","24"],AND:["Andorra","AD","20"],ATA:["Antarctica","AQ","10"],ATG:["Antigua and Barbuda","AG","28"],ARG:["Argentina","AR","32"],ARM:["Armenia","AM","51"],ABW:["Aruba","AW","533"],AFG:["Afghanistan","AF","4"],BHS:["Bahamas","BS","44"],BGD:["Bangladesh","BD","50"],BRB:["Barbados","BB","52"],BHR:["Bahrain","BH","48"],BLZ:["Belize","BZ","84"],BLR:["Belarus","BY","112"],BEL:["Belgium","BE","56"],BEN:["Benin","BJ","204"],BMU:["Bermudas","BM","60"],BGR:["Bulgaria","BG","100"],BOL:["Bolivia","BO","68"],BES:["Bonaire, Sint Eustatius and Saba","BQ","535"],BIH:["Bosnia and Herzegovina","BA","70"],BWA:["Botswana","BW","72"],BRA:["Brazil","BR","76"],IOT:["British Indian Ocean Territory","IO","86"],VGB:["British Virgin Islands","VG","92"],BRN:["Brunei","BN","96"],BFA:["Burkina Faso","BF","854"],BDI:["Burundi","BI","108"],BTN:["butane","BT","64"],VUT:["Vanuatu","VU","548"],VAT:["Vatican","VA","336"],GBR:["Great Britain","GB","826"],HUN:["Hungary","HU","348"],VEN:["Venezuela","VE","862"],UMI:["Minor Outlying Islands (United States)","UM","581"],TLS:["East Timor","TL","626"],VNM:["Vietnam","VN","704"],GAB:["Gabon","GA","266"],HTI:["Haiti","HT","332"],GUY:["Guyana","GY","328"],GMB:["Gambia","GM","270"],GHA:["Ghana","GH","288"],GLP:["Guadeloupe","GP","312"],GTM:["Guatemala","GT","320"],GUF:["Guiana","GF","254"],GIN:["Guinea","GN","324"],GNB:["Guinea-Bissau","GW","624"],DEU:["Germany","DE","276"],GGY:["Guernsey","GG","831"],GIB:["Gibraltar","GI","292"],HND:["Honduras","HN","340"],HKG:["Hong Kong","HK","344"],GRD:["Grenada","GD","308"],GRL:["Greenland","GL","304"],GRC:["Greece","GR","300"],GEO:["Georgia","GE","268"],GUM:["Guam","GU","316"],DNK:["Denmark","DK","208"],JEY:["Jersey","JE","832"],DJI:["Djibouti","DJ","262"],DMA:["Dominica","DM","212"],DOM:["Dominican Republic","DO","214"],COD:["Democratic Republic of the Congo","CD","180"],EGY:["Egypt","EG","818"],ZMB:["Zambia","ZM","894"],ESH:["SADR","EH","732"],ZWE:["Zimbabwe","ZW","716"],ISR:["Israel","IL","376"],IND:["India","IN","356"],IDN:["Indonesia","ID","360"],JOR:["Jordan","JO","400"],IRQ:["Iraq","IQ","368"],IRN:["Iran","IR","364"],IRL:["Ireland","IE","372"],ISL:["Iceland","IS","352"],ESP:["Spain","ES","724"],ITA:["Italy","IT","380"],YEM:["Yemen","YE","887"],CPV:["Cape Verde","CV","132"],KAZ:["Kazakhstan","KZ","398"],CYM:["Cayman Islands","KY","136"],KHM:["Cambodia","KH","116"],CMR:["Cameroon","CM","120"],CAN:["Canada","CA","124"],QAT:["Qatar","QA","634"],KEN:["Kenya","KE","404"],CYP:["Cyprus","CY","196"],KGZ:["Kyrgyzstan","KG","417"],KIR:["Kiribati","KI","296"],TWN:["Republic Of China","TW","158"],PRK:["North Korea","KP","408"],CHN:["China","CN","156"],CCK:["Cocos Islands","CC","166"],COL:["Colombia","CO","170"],COM:["Comoros","KM","174"],CRI:["Costa Rica","CR","188"],CIV:["Côte d'Ivoire","CI","384"],CUB:["Cuba","CU","192"],KWT:["Kuwait","KW","414"],CUW:["Curacao","CW","531"],LAO:["Laos","LA","418"],LVA:["Latvia","LV","428"],LSO:["Lesotho","LS","426"],LBR:["Liberia","LR","430"],LBN:["Lebanon","LB","422"],LBY:["Libya","LY","434"],LTU:["Lithuania","LT","440"],LIE:["Liechtenstein","LI","438"],LUX:["Luxembourg","LU","442"],MUS:["Mauritius","MU","480"],MRT:["Mauritania","MR","478"],MDG:["Madagascar","MG","450"],MYT:["Mayotte","YT","175"],MAC:["Macau","MO","446"],MKD:["Macedonia","MK","807"],MWI:["Malawi","MW","454"],MYS:["Malaysia","MY","458"],MLI:["Mali","ML","466"],MDV:["Maldives","MV","462"],MLT:["Malta","MT","470"],MAR:["Morocco","MA","504"],MTQ:["Martinique","MQ","474"],MHL:["Marshall Islands","MH","584"],MEX:["Mexico","MX","484"],FSM:["Micronesia","FM","583"],MOZ:["Mozambique","MZ","508"],MDA:["Moldavia","MD","498"],MCO:["Monaco","MC","492"],MNG:["Mongolia","MN","496"],MSR:["Montserrat","MS","500"],MMR:["Myanmar","MM","104"],NAM:["Namibia","NA","516"],NRU:["Nauru","NR","520"],NPL:["Nepal","NP","524"],NER:["Niger","NE","562"],NGA:["Nigeria","NG","566"],NLD:["Netherlands","NL","528"],NIC:["Nicaragua","NI","558"],NIU:["Niue","NU","570"],NZL:["New Zealand","NZ","554"],NCL:["New Caledonia","NC","540"],NOR:["Norway","NO","578"],ARE:["UAE","AE","784"],OMN:["Oman","OM","512"],BVT:["Bouvet Island","BV","74"],IMN:["Isle Of Man","IM","833"],COK:["Cook Islands","CK","184"],NFK:["Norfolk Island","NF","574"],CXR:["Christmas Island","CX","162"],PCN:["Pitcairn Islands","PN","612"],SHN:["Saint Helena, Ascension and Tristan da Cunha","SH","654"],PAK:["Pakistan","PK","586"],PLW:["Palau","PW","585"],PSE:["The State of Palestine","PS","275"],PAN:["Panama","PA","591"],PNG:["Papua New Guinea","PG","598"],PRY:["Paraguay","PY","600"],PER:["Peru","PE","604"],POL:["Poland","PL","616"],PRT:["Portugal","PT","620"],PRI:["Puerto-Rico","PR","630"],COG:["Republic of the Congo","CG","178"],KOR:["Republic Of Korea","KR","410"],REU:["Reunion","RE","638"],RUS:["Russia","RU","643"],RWA:["Rwanda","RW","646"],ROU:["Romania","RO","642"],SLV:["Salvador","SV","222"],WSM:["Samoa","WS","882"],SMR:["San Marino","SM","674"],STP:["Sao Tome and Principe","ST","678"],SAU:["Saudi Arabia","SA","682"],SWZ:["Swaziland","SZ","748"],MNP:["Northern Mariana Islands","MP","580"],SYC:["Seychelles","SC","690"],BLM:["Saint Barthelemy","BL","652"],MAF:["Saint-Martin","MF","663"],SPM:["Saint Pierre and Miquelon","PM","666"],SEN:["Senegal","SN","686"],VCT:["Saint Vincent and the Grenadines","VC","670"],
KNA:["Saint Kitts and Nevis","KN","659"],LCA:["St. Lucia","LC","662"],SRB:["Serbia","RS","688"],SGP:["Singapore","SG","702"],SXM:["Sint Maarten","SX","534"],SYR:["Syria","SY","760"],SVK:["Slovakia","SK","703"],SVN:["Slovenia","SI","705"],SLB:["Solomon Islands","SB","90"],SOM:["Somalia","SO","706"],SDN:["Sudan","SD","729"],SUN:["USSR","SU","810"],SUR:["Surinam","SR","740"],USA:["United States of America","US","840"],SLE:["Sierra Leone","SL","694"],TJK:["Tajikistan","TJ","762"],THA:["Thailand","TH","764"],TZA:["Tanzania","TZ","834"],TCA:["Turks and Caicos Islands","TC","796"],TGO:["Togo","TG","768"],TKL:["Tokelau","TK","772"],TON:["Tonga","TO","776"],TTO:["TongaTrinidad and Tobago","TT","780"],TUV:["Tuvalu","TV","798"],TUN:["Tunisia","TN","788"],TKM:["Turkmenistan","TM","795"],TUR:["Turkey","TR","792"],UGA:["Uganda","UG","800"],UZB:["Uzbekistan","UZ","860"],UKR:["Ukraine","UA","804"],WLF:["Wallis and Futuna Islands","WF","876"],URY:["Uruguay","UY","858"],FRO:["Faroe Islands","FO","234"],FJI:["Fiji","FJ","242"],PHL:["Philippines","PH","608"],FIN:["Finland","FI","246"],FLK:["Falkland Islands","FK","238"],FRA:["France","FR","250"],PYF:["French Polynesia","PF","258"],ATF:["French Southern and Antarctic Lands","TF","260"],HMD:["Heard and McDonald Islands","HM","334"],HRV:["Croatia","HR","191"],CAF:["CAR","CF","140"],TCD:["Chad","TD","148"],MNE:["Montenegro","ME","499"],CZE:["Czech Republic","CZ","203"],CHL:["Chile","CL","152"],CHE:["Switzerland","CH","756"],SWE:["Sweden","SE","752"],SJM:["Svalbard and Jan Mayen","SJ","744"],LKA:["Sri Lanka","LK","144"],ECU:["Ecuador","EC","218"],GNQ:["Equatorial Guinea","GQ","226"],ERI:["Eritrea","ER","232"],EST:["Estonia","EE","233"],ETH:["Ethiopia","ET","231"],ZAF:["Republic of South Africa","ZA","710"],SGS:["South Georgia and South Sandwich Islands","GS","239"],SSD:["Southern Sudan","SS","728"],JAM:["Jamaica","JM","388"],JPN:["Japan","JP","392"]},app.cities=[["Moscow","MSK","Moscow","Moscva","Moskva","Mosckwa","Mosckva","Moskow","Moscov","Масква","Москва"],["St. Petersburg","SPB","Питер","Петроград","Piter","Ст-Петербург","Петербург","Санкт Петербург","sanct-peterburg","sant-peterburg","СанктПетербург","Sankt-Peterburg","Saint Petersburg","St Petersburg","aintPetersburg","SanktPeterburg","Санкт-Петербург"],["Novosibirsk","Novosibirsk","Novocibirsk","Novosibirsck","Новосибирск"],["Ekaterinburg","EKB","Ekaterinburg","E-burg","Eburg","Yo-burg","yoburg","Екатеринбург"],["Nizhny Novgorod","N.Novgorod","Nizhnij Novgorod","Nizhniy Novgorod","Nizhny Novgorod","N.Novhorod","Nizhny Novgorod","Nizhnynovgorod","Нижний Новгород"],["Kazan","Kazan","Kazan","Qazan","Казань"],["Samara","Samara","Camara","Самара"],["Chelyabinsk","Cheliabinsk","Chelyabinsk","Cheljabinsk","Челябинск"],["Omsk","Ommsk","Omck","Омск"],["Rostov-on-Don","Rostov-na-Donu","Rostov-on-Don","Rostovnadonu","Rostovondon","Ростов-на-Дону","Ростов на Дону","Rostov on Don"],["Ufa","Ufa","Уфа"],["Krasnoyarsk","Krasnoyarsk","Krasnojarsk","Krasnoiarsk","Красноярск"],["Perm","Perm","Премь","Пермь"],["Volgograd","Volgograd","Volhograd","Volgohrad","Volhohrad","Волгоград"],["Voronezh","Voronezh","Voronez","Воронеж"]],app.register("ext","browser-type",function(){return{ie8:document.all&&document.querySelector&&!document.addEventListener?!0:!1,ltie9:document.all&&!window.atob?!0:!1,ltie10:document.all?!0:!1,ie11:-1!==window.navigator.appVersion.indexOf(".NET"),webkit:-1!==window.navigator.appVersion.toLocaleLowerCase().indexOf("webkit")}}),app.register("ext","pubsub",function(){function a(){this.listeners={}}return a.prototype={constructor:a,addListener:function(a,b){"undefined"==typeof this.listeners[a]&&(this.listeners[a]=[]),this.listeners[a].push(b)},removeListener:function(a,b){var c=this.listeners[a];if("undefined"==typeof c)return!1;for(var d=0,e=c.length;e>d;d++)if(c[d]===b){c.splice(d,1);break}},fireEvent:function(a,b){if("undefined"==typeof a)return!1;b=b||{},"undefined"==typeof b.context&&(b.context=this);var c=this.listeners[a];if("undefined"==typeof c)return!1;for(var d=0,e=c.length;e>d;d++)c[d].apply(b.context,[].slice.call(arguments,1))}},new a}),app.register("ext","tools",function(){return{monthWordHash:{"01":"января","02":"февраля","03":"марта","04":"апреля","05":"мая","06":"июня","07":"июля","08":"августа","09":"сентября",10:"октября",11:"ноября",12:"декабря"},monthWordHash2:{"01":"январь","02":"февраль","03":"март","04":"апрель","05":"май","06":"июнь","07":"июль","08":"август","09":"сентябрь",10:"октябрь",11:"ноябрь",12:"декабрь"},monthWordHash3:{"01":"январе","02":"феврале","03":"марте","04":"апреле","05":"мае","06":"июне","07":"июле","08":"августе","09":"сентябре",10:"октябре",11:"ноябре",12:"декабре"},monthWordHashRev:{"января":"01","февраля":"02","марта":"03","апреля":"04","мая":"05","июня":"06","июля":"07","августа":"08","сентября":"09","октября":"10","ноября":"11","декабря":"12"},monthWordHashRevEn:{January:"01",February:"02",March:"03",April:"04",May:"05",June:"06",July:"07",August:"08",September:"09",October:"10",November:"11",December:"12"},monthWordHashEn:{"01":"January","02":"February","03":"March","04":"April","05":"May","06":"June","07":"July","08":"August","09":"September",10:"October",11:"November",12:"December"},cur:{usd:"$",gbp:"£",eur:"€",jpy:"¥",cny:"¥"},bind:function(a,b){return function(){return b.apply(a,[].slice.call(arguments))}},trim:function(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},extendDeep:function(a,b){var c,d=Object.prototype.toString,e="[object Array]";b=b||{};for(c in a)a.hasOwnProperty(c)&&("object"==typeof a[c]?(b[c]=d.call(a[c])===e?[]:{},this.extendDeep(a[c],b[c])):b[c]=a[c]);return b},findAllEntries:function(a,b){for(var c=-1,d=[];-1!==(c=a.indexOf(b,c+1));)d.push(c);return d},round:function(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)},colorLum:function(a,b){a=String(a).replace(/[^0-9a-f]/gi,""),a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),b=b||0;var c,d,e="#";for(d=0;3>d;d++)c=parseInt(a.substr(2*d,2),16),c=Math.round(Math.min(Math.max(0,c+c*b),255)).toString(16),e+=("00"+c).substr(c.length);return e},closest:function(a,b){for(var c=a;"body"!==c.tagName.toLowerCase();)if(c=c.parentNode,c.classList.contains(b))return c;return null},addListener:function(a,b,c){document.addEventListener?a.addEventListener(b,c):a.attachEvent("on"+b,c)},removeListener:function(a,b,c){document.removeEventListener?a.removeEventListener(b,c):a.detachEvent("on"+b,c)},delegateFocus:function(a,b){a.addEventListener?a.addEventListener("focus",b,!0):a.attachEvent("onfocusin",b)},delegateBlur:function(a,b){a.addEventListener?a.addEventListener("blur",b,!0):a.attachEvent("onfocusout",b)},getStyle:function(a){return window.getComputedStyle?getComputedStyle(a,""):a.currentStyle},moveCaretTo:function(a,b){if(a.createTextRange){var c=a.createTextRange();c.collapse(),c.moveStart("character",b),c.select()}else a.setSelectionRange(b,b)},getChar:function(a){return null==a.which?String.fromCharCode(a.keyCode):String.fromCharCode(a.which)},scrollBarWidth:function(){var a=document.createElement("div");a.style.cssText="width: 100px; height: 100px; overflow: auto; position: absolute; visibility: hidden;",a.innerHTML=" Lorem ipsum dolor sit amet, consectetur adipisicing elit.A alias animi, dolorem dolores iure modi molestias natus necessitatibus,odit perspiciatis porro quaerat quo, quod quos tempore tenetur ut vero vitae.",document.body.appendChild(a);var b=a.offsetWidth-a.clientWidth;return a.parentNode.removeChild(a),b}(),strToDate:function(a,b){var c=a.split(b);return 2===c[2].length&&(c[2]="20"+c[2]),"0"===c[1].charAt(0)&&(c[1]=c[1].slice(1)),"0"===c[0].charAt(0)&&(c[0]=c[0].slice(1)),c[2]=parseInt(c[2],10),c[1]=parseInt(c[1],10)-1,c[0]=parseInt(c[0],10),new Date(c[2],c[1],c[0])},dateToStr:function(a,b){var c=a.getFullYear(),d=a.getMonth()+1+"";1===d.length&&(d="0"+d);var e=a.getDate()+"";return 1===e.length&&(e="0"+e),e+b+d+b+c},strWithFullMonthToDateStr:function(a,b){"en"===b&&(a=a.replace(/,\s+/g," "));var c=a.split(" ");return"ru"===b?c[0]+"."+this.monthWordHashRev[c[1]]+"."+c[2]:"en"===b?c[1]+"."+this.monthWordHashRevEn[c[0]]+"."+c[2]:void 0},strWithFullMonthToDate:function(a,b){return a=this.strWithFullMonthToDateStr(a,b),this.strToDate(a,".")},dateStrToStrWithFullMonth:function(a,b){var c=a.split(".");return"ru"===b?c[0]+" "+this.monthWordHash[c[1]]+" "+c[2]:"en"===b?this.monthWordHashEn[c[1]]+" "+c[0]+", "+c[2]:void 0},strToNum:function(a){return parseFloat(a.replace(/\s*/g,"").replace(/&nbsp;/g,"").replace(",","."))},numToStr:function(a){a=""+a;var b,c,d=a.indexOf(".");-1!==d?(b=a.slice(0,d),c=a.slice(d+1)):(b=a.slice(0),c="00"),1==c.length&&(c+="0");for(var e="",f=b.length,g=f-1,h=0;g>=0;g--)e=b.substr(g,1)+e,h++,3==h&&g&&(h=0,e=" "+e);return e+","+c},handleRuCase:function(a,b,c,d,e,f){if(-1!==b.innerHTML.indexOf(f)){var g=a.innerHTML.length,h=a.innerHTML;1===g?"1"===h?b.innerHTML=c:"2"===h||"3"===h||"4"===h?b.innerHTML=d:b.innerHTML=e:g>1&&("1"===h.charAt(g-1)&&"1"!==h.charAt(g-2)?b.innerHTML=c:"2"!==h.charAt(g-1)&&"3"!==h.charAt(g-1)&&"4"!==h.charAt(g-1)||"1"===h.charAt(g-2)?b.innerHTML=e:b.innerHTML=d)}},handleEnCase:function(a,b,c,d,e){if(-1!==b.innerHTML.indexOf(e)){var f=a.innerHTML;1==f?b.innerHTML=c:b.innerHTML=d}},changeCurrencies:function(a){for(var b=0,c=a.length;c>b;b++){var d=a[b].innerHTML.toLowerCase();"rub"!==d&&"rur"!==d||app.ext["browser-type"].ie8?void 0!==this.cur[d]&&(a[b].innerHTML=this.cur[d]):(a[b].innerHTML="",a[b].classList.add("_rub"))}}}}),app.register("ext","mediaIE8",function(){return{handleScreenSize:function(){var a=17;document.documentElement.clientWidth+a<=1359&&document.documentElement.clientWidth+a>1300?(app.el.classList.add("js-lte-1359"),app.el.classList.remove("js-lte-1300"),app.el.classList.remove("js-lte-1260"),app.el.classList.remove("js-lte-1220"),app.el.classList.remove("js-lte-1170"),app.el.classList.remove("js-lte-1070")):document.documentElement.clientWidth+a<=1300&&document.documentElement.clientWidth+a>1260?(app.el.classList.add("js-lte-1359"),app.el.classList.add("js-lte-1300"),app.el.classList.remove("js-lte-1260"),app.el.classList.remove("js-lte-1220"),app.el.classList.remove("js-lte-1170"),app.el.classList.remove("js-lte-1070")):document.documentElement.clientWidth+a<=1260&&document.documentElement.clientWidth+a>1220?(app.el.classList.add("js-lte-1359"),app.el.classList.add("js-lte-1300"),app.el.classList.add("js-lte-1260"),app.el.classList.remove("js-lte-1220"),app.el.classList.remove("js-lte-1170"),app.el.classList.remove("js-lte-1070")):document.documentElement.clientWidth+a<=1220&&document.documentElement.clientWidth+a>1170?(app.el.classList.add("js-lte-1359"),app.el.classList.add("js-lte-1300"),app.el.classList.add("js-lte-1260"),app.el.classList.add("js-lte-1220"),app.el.classList.remove("js-lte-1170"),app.el.classList.remove("js-lte-1070")):document.documentElement.clientWidth+a<=1170&&document.documentElement.clientWidth+a>1070?(app.el.classList.add("js-lte-1359"),app.el.classList.add("js-lte-1300"),app.el.classList.add("js-lte-1260"),app.el.classList.add("js-lte-1220"),app.el.classList.add("js-lte-1170"),app.el.classList.remove("js-lte-1070")):document.documentElement.clientWidth+a<=1070&&(app.el.classList.add("js-lte-1359"),app.el.classList.add("js-lte-1300"),app.el.classList.add("js-lte-1260"),app.el.classList.add("js-lte-1220"),app.el.classList.add("js-lte-1170"),app.el.classList.add("js-lte-1070"))},addResizeHandler:function(){app.ext.tools.addListener(window,"resize",this.handleScreenSize)},init:function(){this.handleScreenSize(),this.addResizeHandler()}}}),app.register("ext","tmp",function(){return function(a){function b(a,b,c){e+=b?'ar.push("'+a.replace(/"/g,'\\"')+'");\n':c.match(/<%=/)?"ar.push("+a.replace(/"/g,'\\"')+");\n":a+"\n"}a=app.ext.tools.trim(a).replace(/\n/g," ").replace(/\s+/," ");for(var c,d=/<%=?([\s\S]+?)%>/g,e="var ar = [];\n",f=0;c=d.exec(a);)b(a.slice(f,c.index),!0),b(c[1],!1,c[0]),f=c.index+c[0].length;return b(a.slice(f),!0),e+='return ar.join("");',new Function("data",e.replace(/[\n\r\t]/g,""))}}),app.register("ui","datepicker",function(){function a(a){this.el=a.el,this.monthEl=this.el.querySelector("._month"),this.yearEl=this.el.querySelector("._year"),this.next=this.el.querySelector("._next"),this.prev=this.el.querySelector("._prev"),this.body=this.el.querySelector(".datepicker_body"),this.en=app.en,this.outputElId=this.el.getAttribute("data-el-id"),this.hideonblur=this.el.classList.contains("js-hideonblur"),"abs"===this.el.getAttribute("data-pos")&&(this.el.style.cssText="position: absolute; top: "+this.el.getAttribute("data-top")+"; left: "+this.el.getAttribute("data-left")+"; display: "+this.el.getAttribute("data-display")+";"),this.currentDay=null,this.selectedDay=null,this.maxDay=null,this.minDay=null,this.initialize()}return a.prototype={constructor:a,monthHash:{0:"Январь",1:"Февраль",2:"Март",3:"Апрель",4:"Май",5:"Июнь",6:"Июль",7:"Август",8:"Сентябрь",9:"Октябрь",10:"Ноябрь",11:"Декабрь"},monthHashEn:{0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"},parseStrToDate:function(a){var b=a.split(".");return 2===b[2].length&&(b[2]="20"+b[2]),"0"===b[1].charAt(0)&&(b[1]=b[1].slice(1)),"0"===b[0].charAt(0)&&(b[0]=b[0].slice(1)),b[2]=parseInt(b[2],10),b[1]=parseInt(b[1],10)-1,b[0]=parseInt(b[0],10),new Date(b[2],b[1],b[0])},initialize:function(){this.defineDates(),this.drawDatepicker(this.date),this.bindEvents()},defineDates:function(){var a=this.el.getAttribute("data-show"),b=this.el.getAttribute("data-min"),c=this.el.getAttribute("data-max");this.dateShow=a?this.parseStrToDate(a):null,b?"current"===b?this.minDate=new Date:this.minDate=this.parseStrToDate(b):this.minDate=null,c?"current"===c?this.maxDate=new Date:this.maxDate=this.parseStrToDate(c):this.maxDate=null,this.date=this.dateShow||this.date||new Date,this.el.setAttribute("data-show",""),this.dateShow=null},drawDatepicker:function(a){var b=this.getDefinitions(a);this.body.innerHTML=this.getDatepickerHtml(b)},getDefinitions:function(a){this.month=a.getMonth(),this.year=a.getFullYear(),this.defineCurrentDateIfExist(),this.defineSelectedDateIfExist(),this.handleMaxDayIfExist(),this.handleMinDayIfExist(),a.setDate(1);var b=a.getDay();0===b&&(b=7);var c=new Date(this.year,this.month+1,0).getDate(),d=new Date(this.year,this.month,0).getDate(),e=b-1,f=Math.ceil((e+c)/7);return{dayInPrevMonth:d,prevMonthDaysToPrint:e,dayInThisMonth:c,rowsQty:f,day:b}},defineCurrentDateIfExist:function(){var a=new Date;a.getFullYear()===this.year&&a.getMonth()===this.month?this.currentDay=a.getDate():this.currentDay=null},defineSelectedDateIfExist:function(){if(!this.selectedDate)return!1;var a=this.selectedDate;a.getFullYear()===this.year&&a.getMonth()===this.month?this.selectedDay=a.getDate():this.selectedDay=null},handleMaxDayIfExist:function(){if(!this.maxDate)return!1;var a=this.maxDate;a.getFullYear()===this.year&&a.getMonth()===this.month?(this.maxDay=a.getDate(),this.next.classList.add("-disabled")):(this.maxDay=null,this.next.classList.remove("-disabled"))},handleMinDayIfExist:function(){if(!this.minDate)return!1;var a=this.minDate;a.getFullYear()===this.year&&a.getMonth()===this.month?(this.minDay=a.getDate(),this.prev.classList.add("-disabled")):(this.minDay=null,this.prev.classList.remove("-disabled"))},getDatepickerHtml:function(a){this.monthEl.innerHTML=this.en?this.monthHashEn[this.month]:this.monthHash[this.month],this.yearEl.innerHTML=this.year;var b=this.getPrevDays(a.dayInPrevMonth,a.prevMonthDaysToPrint),c=this.getNextDays(a.dayInThisMonth,a.rowsQty,a.day),d=this.getCurrentDays(a.dayInThisMonth),e=b.concat(d,c),f=this.getDataInRows(e);return this.getTable(f)},getPrevDays:function(a,b){for(var c=[],d=a;d>a-b;d--)c.push('<td class="datepicker_td -disabled">'+d+"</td>");return c.reverse()},getNextDays:function(a,b,c){for(var d=7*b-a-(c-1),e=[],f=1;d>=f;f++)e.push('<td class="datepicker_td -disabled">'+f+"</td>");return e},getCurrentDays:function(a){for(var b=[],c=1;a>=c;c++){var d="datepicker_td";this.currentDay&&c===this.currentDay&&this.selectedDay&&c===this.selectedDay?d+=" _current -selected":this.currentDay&&c===this.currentDay?d+=" _current":this.selectedDay&&c===this.selectedDay&&(d+=" -selected"),this.maxDay&&c>this.maxDay&&(d+=" -disabled"),this.minDay&&c<this.minDay&&(d+=" -disabled"),b.push('<td class="'+d+'">'+c+"</td>")}return b},getDataInRows:function(a){for(var b=[],c='<tr class="datepicker_tr">',d=1,e=a.length;e>=d;d++)c+=a[d-1],d%7===0&&(c+="</tr>",b.push(c),c='<tr class="datepicker_tr">');return b},getTable:function(a){for(var b="<table>",c=0,d=a.length;d>c;c++)b+=a[c];return b+="</table>"},getNextMonth:function(){11===this.month?(this.year++,this.month=0):this.month++,this.day=1,this.date=new Date(this.year,this.month),this.drawDatepicker(this.date)},getPrevMonth:function(){0===this.month?(this.year--,this.month=11):this.month--,this.day=1,this.date=new Date(this.year,this.month),this.drawDatepicker(this.date)},checkIncomingDate:function(a){if(10===a.length){var b=new RegExp("^(0[1-9]|[12][0-9]|3[01])\\.(0[1-9]|1[012])\\.(19|20)\\d\\d$");if(b.test(a)){var c=this.parseStrToDate(a);return this.maxDate&&c.getTime()>this.maxDate.getTime()?!1:this.minDate&&c.getTime()<this.minDate.getTime()?!1:!0}}return!1},show:function(a){a&&a.date&&(this.checkIncomingDate(a.date)?(this.date=this.parseStrToDate(a.date),this.selectedDate=this.date,this.selectedDay=this.date.getDate()):(this.date=this.dateShow||new Date,this.selectedDate=null,this.selectedDay=null)),this.defineDates(),this.drawDatepicker(this.date),this.el.style.display="block",app.ext.pubsub.fireEvent("datepicker:shown",{elId:this.outputElId}),app.ext.pubsub.fireEvent("close-other-dropdowns",{id:this.el.id}),app.historyDropdownOpened=!0},hide:function(){this.el.style.display="none",app.ext.pubsub.fireEvent("datepicker:hidden",{elId:this.outputElId}),app.historyDropdownOpened=!1},notifyAboutChanges:function(a,b){app.ext.pubsub.fireEvent("date:"+this.outputElId+":changed",{date:a,dateStr:b})},bindEvents:function(){app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickDatepickerCell)),app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickMoveCtrl)),app.ext.tools.addListener(app.el,"click",app.ext.tools.bind(this,this.hide)),app.ext.pubsub.addListener("datepicker:"+this.outputElId+":show",app.ext.tools.bind(this,this.show)),app.ext.pubsub.addListener("datepicker:"+this.outputElId+":hide",app.ext.tools.bind(this,this.hide)),app.ext.pubsub.addListener("close-other-dropdowns",app.ext.tools.bind(this,this.onCloseOtherDropdowns))},onclickDatepickerCell:function(a){var b=a||window.event,c=b.target||b.srcElement;if(b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,c.classList.contains("datepicker_td")){if(c.classList.contains("-selected")||c.classList.contains("-disabled"))return!1;var d=this.el.querySelector(".-selected");d&&d.classList.remove("-selected"),c.classList.add("-selected");var e=c.innerHTML,f=+this.month+1+"",g=(e=1===e.length?"0"+e:e)+"."+(f=1===f.length?"0"+f:f)+"."+this.year;this.selectedDate=new Date(this.year,this.month,parseInt(e,10)),this.notifyAboutChanges(this.selectedDate,g),this.hide()}},onclickMoveCtrl:function(a){var b=a||window.event,c=b.target||b.srcElement;if(c.classList.contains("datepicker_move")){if(b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,c.classList.contains("-disabled"))return!1;c.classList.contains("_next")&&this.getNextMonth(),c.classList.contains("_prev")&&this.getPrevMonth()}},onCloseOtherDropdowns:function(a){return a.id===this.el.id?!1:void this.hide()}},{init:function(){var b=document.querySelectorAll(".b-datepicker");if(0!==b.length)for(var c=0,d=b.length;d>c;c++)this.datepickers.push(new a({el:b[c]}))},datepickers:[]}}),app.register("module","title",function(){function a(a){if(this.el=a.el,!app.ext["browser-type"].ie8){var b=app.el.querySelector(".js-title");if(b){var c=b.innerHTML;c=c.replace(/XXXXXXXXXX(XX)(1234)/i,"$1 $2").replace(/X/gi,"&bull;"),this.el.innerHTML=c}}}return{init:function(){var b=document.getElementsByTagName("title")[0];null!==b&&new a({el:b})}}}),app.register("module","main",function(){function a(a){this.el=a.el,this.en=app.en,this.initialize()}return a.prototype={constructor:a,initialize:function(){this.handleReportFormedDate()},handleReportFormedDate:function(){var a=this.el.querySelector(".js-date"),b=app.ext.tools.trim(a.innerHTML);a.innerHTML=this.en?app.ext.tools.dateStrToStrWithFullMonth(b,"en"):app.ext.tools.dateStrToStrWithFullMonth(b,"ru")}},{init:function(){var b=document.querySelector(".b-main");null!==b&&new a({el:b})}}}),app.register("module","card-opers",function(){function a(a){this.el=a.el,this.items=this.el.querySelectorAll(".card-opers_item"),this.bonusContainer=this.el.querySelector(".card-opers_bonus"),this.initialize()}return a.prototype={constructor:a,initialize:function(){this.modOpersSums(),this.bonusContainer&&(this.handleBonusCell(),this.handleBonusTotalValue())},modOpersSums:function(){for(var a=0,b=this.items.length;b>a;a++){var c=this.items[a].querySelector(".card-opers_item-value"),d=app.ext.tools.trim(c.innerHTML),e=d.split(",");1===e.length?c.innerHTML='<span class="_integer">'+e[0]+"</span>":c.innerHTML='<span class="_integer">'+e[0]+'</span>,<span class="_fraction">'+e[1]+"</span>"}},handleBonusCell:function(){var a=this.bonusContainer.querySelector(".card-opers_item-currency");if(a){var b=this.bonusContainer.querySelector(".card-opers_item-value ._integer");app.el.classList.contains("_en")?app.ext.tools.handleEnCase(b,a,"mile","miles","mil"):app.ext.tools.handleRuCase(b,a,"миля","мили","миль","мил")}},handleBonusTotalValue:function(){var a=this.bonusContainer.querySelector(".card-opers_total-currency");if(a){var b=this.bonusContainer.querySelector(".card-opers_total-value");app.el.classList.contains("_en")?app.ext.tools.handleEnCase(b,a,"bonus","bonuses","bonus"):app.ext.tools.handleRuCase(b,a,"бонус","бонуса","бонусов","бонус")}}},{init:function(){var b=document.querySelector(".b-card-opers");null!==b&&new a({el:b})}}}),app.register("module","state",function(){function a(a){this.el=a.el,this.overdue=document.getElementById("OverduePayment"),this.dropDown=this.el.querySelector(".state_details-add"),this.dropDownInner=this.el.querySelector(".state_details-add-inner"),this.en=app.en,this.active=!1,this.initialize()}return a.prototype={constructor:a,initialize:function(){this.handleOverdue(),this.handleStateDates(),this.bindEvents()},handleStateDates:function(){for(var a=this.el.querySelectorAll(".js-date"),b=0,c=a.length;c>b;b++){var d=a[b],e=app.ext.tools.trim(d.innerHTML);d.innerHTML=this.en?app.ext.tools.dateStrToStrWithFullMonth(e,"en"):app.ext.tools.dateStrToStrWithFullMonth(e,"ru")}},handleOverdue:function(){return this.overdue?void(app.ext.tools.strToNum(this.overdue.innerHTML)?(this.active=!0,this.overdue.style.color="#b22200",app.ext["browser-type"].ie8||(this.dropDown.style.height=this.dropDown.offsetHeight+"px",this.dropDownInner.style.top=0)):app.ext["browser-type"].ie8?this.dropDown.style.display="none":(this.dropDownInner.style.top="-"+this.dropDown.offsetHeight+"px",this.dropDown.style.height="0px")):!1},bindEvents:function(){app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.toggleDropDown)),app.ext["browser-type"].ie8||app.ext.tools.addListener(window,"resize",app.ext.tools.bind(this,this.onresizeWindow))},onresizeWindow:function(){if("0px"!=this.dropDown.style.height)this.dropDown.style.height="auto";else{var a=this.dropDownInner.offsetHeight+"px";this.dropDownInner.style.top="-"+a}},toggleDropDown:function(a){var b=a||window.event,c=b.target||b.srcElement,d=app.ext.tools.closest(c,"_trigger");if(c.classList.contains("_trigger")||null!==d){if(!app.ext["browser-type"].ie8)var e=this.dropDownInner.offsetHeight+"px";this.active?(app.ext["browser-type"].ie8?this.dropDown.style.height=0:(this.dropDown.style.height=e,this.dropDownInner.style.top="-"+this.dropDown.offsetHeight+"px",this.dropDown.style.height=0),this.active=!1):(app.ext["browser-type"].ie8?this.dropDown.style.height="auto":(this.dropDown.style.height=e,this.dropDownInner.style.top=0),this.active=!0)}}},{init:function(){var b=document.querySelector(".b-state");null!==b&&new a({el:b})}}}),app.register("module","balance",function(){function a(a){this.el=a.el,this.startDate=this.el.querySelector(".js-start-date"),this.endDate=this.el.querySelector(".js-end-date"),this.en=app.en,this.initialize()}return a.prototype={constructor:a,initialize:function(){this.setDatesToBalance()},setDatesToBalance:function(){var a=app.ext.tools.dateToStr(app.periodStartDate,"."),b=app.ext.tools.dateToStr(app.periodEndDate,".");this.startDate.innerHTML=this.en?app.ext.tools.dateStrToStrWithFullMonth(a,"en"):app.ext.tools.dateStrToStrWithFullMonth(a,"ru"),this.endDate.innerHTML=this.en?app.ext.tools.dateStrToStrWithFullMonth(b,"en"):app.ext.tools.dateStrToStrWithFullMonth(b,"ru")},handleBalanceDates:function(){for(var a=this.el.querySelectorAll(".js-date"),b=0,c=a.length;c>b;b++){var d=a[b],e=app.ext.tools.trim(d.innerHTML);d.innerHTML=this.en?app.ext.tools.dateStrToStrWithFullMonth(e,"en"):app.ext.tools.dateStrToStrWithFullMonth(e,"ru")}}},{init:function(){var b=document.querySelector(".b-balance");null!==b&&new a({el:b})}}}),app.register("module","past-period",function(){function a(a){this.el=a.el,this.dropDown=this.el.querySelector(".past-period_content-wrapper"),this.dropDownInner=this.el.querySelector(".past-period_content-inner"),this.overduePayment=document.getElementById("StateOverduePayment"),this.overdueTotal=document.getElementById("OverdueTotal"),this.statusOk=this.el.querySelector(".past-period_status._ok"),this.statusOverdue=this.el.querySelector(".past-period_status._overdue"),this.active=!1,this.initialize()}return a.prototype={constructor:a,initialize:function(){this.handleOverdue(),this.bindEvents()},handleOverdue:function(){app.ext.tools.strToNum(this.overduePayment.innerHTML)?(this.overduePayment.style.color="#b22200",this.overdueTotal.style.color="#b22200",this.statusOk.style.display="none",this.statusOverdue.style.display="block",this.active=!0,app.ext["browser-type"].ie8||(this.dropDown.style.height=this.dropDown.offsetHeight+"px",this.dropDownInner.style.top=0)):(this.statusOk.style.display="block",this.statusOverdue.style.display="none",app.ext["browser-type"].ie8?this.dropDown.style.display="none":(this.dropDownInner.style.top="-"+this.dropDown.offsetHeight+"px",this.dropDown.style.height="0px"))},bindEvents:function(){app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.toggleDropDown)),app.ie8||app.ext.tools.addListener(window,"resize",app.ext.tools.bind(this,this.onresizeWindow))},onresizeWindow:function(){if("0px"!=this.dropDown.style.height)this.dropDown.style.height="auto";else{var a=this.dropDownInner.offsetHeight+"px";this.dropDownInner.style.top="-"+a}},toggleDropDown:function(a){var b=a||window.event,c=b.target||b.srcElement,d=app.ext.tools.closest(c,"past-period_header-name");if(c.classList.contains("past-period_header-name")||null!==d){if(!app.ext["browser-type"].ie8)var e=this.dropDownInner.offsetHeight+"px";this.active?(app.ext["browser-type"].ie8?this.dropDown.style.display="none":(this.dropDown.style.height=e,this.dropDownInner.style.top="-"+this.dropDown.offsetHeight+"px",this.dropDown.style.height=0),this.active=!1):(app.ext["browser-type"].ie8?this.dropDown.style.display="block":(this.dropDown.style.height=e,this.dropDownInner.style.top=0),this.active=!0)}}},{init:function(){var b=document.querySelector(".b-past-period");null!==b&&new a({el:b})}}}),app.register("module","card",function(){function a(a){this.el=a.el,this.cardNumber=this.el.querySelector(".card_number"),this.cardPosterSrc=this.el.querySelector(".card_poster-src"),this.posterImg=this.el.querySelector(".card_poster"),this.partnerImg=this.el.querySelector(".card_partnership"),this.paysysImg=this.el.querySelector(".card_pay-system"),this.cardCurrencyEl=this.el.querySelector(".card_currency-value"),this.cardName=this.el.querySelector(".card_name"),this.expiryVal=this.el.querySelector(".card_expiry-value"),this.initialize()}return a.prototype={constructor:a,cur:{USD:"$",GBP:"£",EUR:"€",JPY:"¥",CNY:"¥"},initialize:function(){this.bindEvents(),app.ext["browser-type"].webkit&&this.el.classList.contains("_small")&&this.adaptSmallLabelsToWebkit(),this.setMainCardCurrencyToApp(),this.setImgSrcs(),this.setCardColorAndBg(),this.replaceCardCrossesToDottes(),this.changeCurrencies()},setMainCardCurrencyToApp:function(){app.cur=app.ext.tools.trim(this.cardCurrencyEl.innerHTML.toLowerCase())},setImgSrcs:function(){this.posterImg.src=this.el.querySelector(".card_poster-src").innerHTML;var a=this.el.querySelector(".card_partnership-src");a&&""!==a?this.partnerImg.src=a.innerHTML:this.partnerImg.style.display="none",this.el.querySelector(".card_pay-system").src=this.el.querySelector(".card_pay-system-src").innerHTML},setCardColorAndBg:function(){var a,b,c=this.cardPosterSrc.innerHTML,d=c.slice(0,-4),e=d.split("--");this.el.classList.contains("_main")?(app.mainCardBG=a=e[1],app.mainCardColor=b=e[2]):(a=e[1],b=e[2]),"white"===b&&this.el.classList.add("_white"),"transparent"!==this.el.style.backgroundColor&&(this.el.style.backgroundColor="#"+a)},replaceCardCrossesToDottes:function(){var a=this.cardNumber.innerHTML.replace(/\s/g,""),b=this.getCardNumParts(a),c=this.getCardNumPartsHtml(b);this.cardNumber.innerHTML=c.replace(/X/g,"&bull;"),this.cardNumber.classList.add("_l"+a.length)},getCardNumParts:function(a){var b=[];return b.push(a.slice(0,4)),b.push(a.slice(4,8)),b.push(a.slice(8,12)),b.push(a.slice(12)),b},getCardNumPartsHtml:function(a){for(var b="",c=0,d=a.length;d>c;c++)b+='<div class="card_number-item">'+a[c]+"</div>";return b},changeCurrencies:function(){var a=this.cardCurrencyEl,b=app.ext.tools.trim(a.innerHTML);"rub"!==b.toLowerCase()&&"rur"!==b.toLowerCase()||app.ext["browser-type"].ie8?void 0!==this.cur[b]&&(a.innerHTML=this.cur[b]):(a.innerHTML="",a.classList.add("_rub"))},adaptSmallLabelsToWebkit:function(){var a=this.el.querySelector(".card_expiry-label"),b=this.el.querySelector(".card_currency-label");a.style.textTransform="none",a.style.fontVariant="small-caps",a.style.fontSize="7px",b.style.textTransform="none",b.style.fontVariant="small-caps",b.style.fontSize="7px"},bindEvents:function(){var a=this;this.posterImg.onload=function(){a.el.style.backgroundColor="transparent"},this.posterImg.onerror=function(){a.posterImg.parentNode.removeChild(a.posterImg)},this.paysysImg.onload=function(){a.paysysImg.height=Math.floor(a.paysysImg.height/2)},this.paysysImg.onerror=function(){a.paysysImg.parentNode.removeChild(a.paysysImg)},this.partnerImg.onload=function(){a.partnerImg.height=Math.floor(a.partnerImg.height/2)},this.partnerImg.onerror=function(){a.partnerImg.parentNode.removeChild(a.partnerImg)}}},{init:function(){var b=document.querySelectorAll(".b-card");if(null!==b)for(var c=0,d=b.length;d>c;c++)new a({el:b[c]})}}}),app.register("module","extra-cards",function(){function a(a){this.el=a.el,this.info=this.el.querySelector(".extra-cards_info"),this.items=this.el.querySelectorAll(".extra-cards_item"),this.iconTop=this.el.querySelector(".extra-cards_icon-top"),this.iconBottom=this.el.querySelector(".extra-cards_icon-bottom"),this.cardsQty=this.el.querySelector(".extra-cards_cards-qty"),this.infoTPadding=parseInt(app.ext.tools.getStyle(this.info).paddingTop),this.infoBPadding=parseInt(app.ext.tools.getStyle(this.info).paddingBottom),this.items.length>1&&(this.itemTMargin=parseInt(app.ext.tools.getStyle(this.items[1]).marginTop)),this.itemsWithoutScroll=5,this.firstOpen=!0,this.initialize()}return a.prototype={constructor:a,initialize:function(){this.deleteIfNoExtraCards(),this.setIconColors(),this.setExtraCardsQty(),this.bindEvents()},deleteIfNoExtraCards:function(){(0===this.items.length||1===this.items.length)&&(this.el.remove(),
delete app.module["extra-cards"])},handleScroll:function(){if(this.items.length>this.itemsWithoutScroll){var a=this.getItemsHeight(),b=this.getItemsMargin(),c=this.infoTPadding+this.infoBPadding+a+b;this.info.style.height=c+"px",this.info.style.overflow="auto"}},getItemsHeight:function(){for(var a=0,b=0;b<this.itemsWithoutScroll;b++)a+=this.items[b].offsetHeight;return a},getItemsMargin:function(){return(this.itemsWithoutScroll-1)*this.itemTMargin},setIconColors:function(){app.mainCardBG&&app.mainCardColor&&(this.iconTop.style.backgroundColor="#"+app.mainCardBG,this.iconBottom.style.backgroundColor=app.ext.tools.colorLum(app.mainCardBG,-.1),this.cardsQty.style.color=app.mainCardColor)},setExtraCardsQty:function(){this.items.length>0&&(this.cardsQty.innerHTML=this.items.length)},showInfo:function(){this.el.classList.add("-active"),this.info.style.display="block",this.handleScroll(),this.firstOpen&&(app.ext.pubsub.fireEvent("extra-cards:opened-first-time"),this.firstOpen=!1),app.ext.pubsub.fireEvent("close-other-dropdowns",{id:this.el.id}),app.historyDropdownOpened=!0},hideInfo:function(){this.el.classList.remove("-active"),this.info.style.display="none",app.historyDropdownOpened=!1},bindEvents:function(){app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.clickTrigger)),app.ext.tools.addListener(app.el,"click",app.ext.tools.bind(this,this.hideInfo)),app.ext.pubsub.addListener("close-other-dropdowns",app.ext.tools.bind(this,this.onCloseOtherDropdowns))},clickTrigger:function(a){var b=a||window.event,c=b.target||b.srcElement;b.stopPropagation?b.stopPropagation():b.cancelBubble=!0;var d=app.ext.tools.closest(c,"extra-cards_header-text");(c.classList.contains("extra-cards_header-text")||null!==d)&&(this.el.classList.contains("-active")?(this.el.classList.remove("-active"),this.hideInfo()):this.showInfo())},onCloseOtherDropdowns:function(a){return a.id===this.el.id?!1:void this.hideInfo()}},{init:function(){var b=document.querySelector(".b-extra-cards");null!==b&&new a({el:b})}}}),app.register("module","extra-card",function(){function a(a){this.el=a.el,this.icon=this.el.querySelector(".extra-card_icon"),this.paySysImg=this.el.querySelector(".extra-card_pay-system"),this.cardNumber=this.el.querySelector(".extra-card_item._number"),this.cardName=this.el.querySelector(".extra-card_item._name"),this.validDate=this.el.querySelector(".extra-card_item._valid ._date"),this.validText=this.el.querySelector(".extra-card_item._valid ._text"),this.en=app.el.classList.contains("_en"),this.initialize()}return a.prototype={constructor:a,initialize:function(){this.bindEvents(),this.setImgSrcs(),this.setCardBg(),this.handleCardBlocking(),this.replaceCardCrossesToDottes(),this.translateValidDateMonth()},setImgSrcs:function(){this.paySysImg.src=this.el.querySelector(".extra-card_pay-system-src").innerHTML},setCardBg:function(){var a=this.el.querySelector(".extra-card_poster-src").innerHTML,b=a.split("--");this.bgColor=b[1],this.icon.style.backgroundColor="#"+this.bgColor},handleCardBlocking:function(){var a=this.validDate.innerHTML,b=app.ext.tools.strToDate("01."+a,"."),c=new Date(b.getFullYear(),b.getMonth()+1,0);c.getTime()<=app.periodEndDate.getTime()&&(this.el.classList.add("-blocked"),this.icon.style.opacity=.5,app.el.classList.contains("_en")?this.validText.innerHTML="Blocked":this.validText.innerHTML="Заблокирована в",this.writeCardAsBlockedInApp())},writeCardAsBlockedInApp:function(){app.blockedCards||(app.blockedCards=[]),app.blockedCards.push({cardName:app.ext.tools.trim(this.cardName.innerHTML),cardNumber:this.cardNumber.innerHTML.replace(/X/g,"").replace(/\s+/g,"")})},replaceCardCrossesToDottes:function(){var a=this.cardNumber.innerHTML;a=app.ext.tools.trim(a),a=a.replace(/\s+/g,""),a=a.slice(12),this.cardNumber.innerHTML="&bull;&bull;&nbsp;"+a},translateValidDateMonth:function(){var a,b=this.validDate.innerHTML.split(".");a=this.en?this.el.classList.contains("-blocked")?app.ext.tools.monthWordHashEn[b[0]]:app.ext.tools.monthWordHashEn[b[0]]:this.el.classList.contains("-blocked")?app.ext.tools.monthWordHash3[b[0]]:app.ext.tools.monthWordHash2[b[0]],this.validDate.innerHTML=a+(this.en?", ":" ")+b[1]},bindEvents:function(){var a=this;this.paySysImg.onload=function(){a.paySysImg.height=Math.floor(a.paySysImg.height/2),a.paySysImg.width=Math.floor(a.paySysImg.width/2),setTimeout(function(){a.paySysImg.style.marginTop=-a.paySysImg.height/2+"px",a.paySysImg.style.marginLeft=-a.paySysImg.width/2+"px"},100)},this.paySysImg.onerror=function(){a.paySysImg.parentNode.removeChild(a.paySysImg)}}},{init:function(){var b=document.querySelectorAll(".b-extra-card");if(null!==b)for(var c=0,d=b.length;d>c;c++)new a({el:b[c]})}}}),app.register("module","card-info",function(){function a(a){this.el=a.el,this.initialize()}return a.prototype={constructor:a,initialize:function(){app.ext["browser-type"].ie8||this.changeCurrencies(),this.modifyCreditRate()},changeCurrencies:function(){var a=this.el.querySelector("._currency");a&&(a.innerHTML="",a.classList.add("_rub"))},modifyCreditRate:function(){var a=this.el.querySelector(".js-rate");if(a){var b=a.innerHTML;b=b.replace(/,00$/,"").replace(/(,[1-9])0$/,"$1"),a.innerHTML=b}}},{init:function(){var b=document.querySelector(".b-card-info");null!==b&&new a({el:b})}}}),app.register("module","history",function(){function a(a){this.el=a.el,this.dataEl=document.getElementById("HistoryData"),this.titleText=this.el.querySelector(".history_title-text"),this.dataSplitter="&lt;-&gt;",this.en=app.en,this.initialize()}return a.prototype={constructor:a,initialize:function(){this.setGroupMap();var a=this.getData();this.jsonData=this.parseDataToJson(a),this.dataEl.parentNode.removeChild(this.dataEl)},setGroupMap:function(){this.groupMap={},this.groupMap.cashless=this.en?"Expenses":"Расходы",this.groupMap.cash=this.en?"Cash withdrawn":"Снятие наличных",this.groupMap.refill=this.en?"Incomes":"Пополнения"},getData:function(){var a=document.getElementById("HistoryHeaders").innerHTML,b=a.split(this.dataSplitter),c=this.dataEl.querySelectorAll(".h_item");return{trs:c,headers:b}},parseDataToJson:function(a){for(var b=[],c=0,d=a.trs.length;d>c;c++){var e=a.trs[c].innerHTML.split(this.dataSplitter),f=a.headers,g=this.createJSONItem(e,f);g.id=c+1+"",g=this.translateMCCForCategory(g),g.cardSum=g.cardSum.replace(/&nbsp;/g," "),g.frnSum=g.frnSum.replace(/&nbsp;/g," "),b.push(g)}return b},createJSONItem:function(a,b){for(var c={},d=0,e=b.length;e>d;d++){var f=app.ext.tools.trim(b[d]);c[f]=app.ext.tools.trim(a[d])}return c},translateMCCForCategory:function(a){"refill"==a.group?a.category+="+":a.category+="-";var b=app.categories[app.mcc[a.category]];return b||(b="refill"==a.group?this.en?"Other incomes":"Прочие пополнения":this.en?"Other expenses":"Прочие расходы"),a.category=b,a},sortData:function(a,b,c,d){function e(a,c){var e=app.ext.tools.strToDate(a[b],".").getTime(),f=app.ext.tools.strToDate(c[b],".").getTime();return d?f-e:e-f}function f(a,c){var e=app.ext.tools.strToNum(a[b]),f=app.ext.tools.strToNum(c[b]);return d?f-e:e-f}return"date"===c?a.sort(app.ext.tools.bind(this,e)):"sum"===c&&a.sort(app.ext.tools.bind(this,f)),a}},{init:function(){var b=document.querySelector(".b-history");null!==b&&(app.module.history=new a({el:b}))}}}),app.register("module","categories",function(){function a(a){this.el=a.el,this.parent=a.parent,this.main=this.el.querySelector(".categories_main"),this.reset=this.el.querySelector(".categories_reset"),this.en=app.en,this.catIdCounter=0,this.grIdCounter=0,this.deactivatedCategories=[],this.initIndicator=!0,this.subgradeInactiveColor="#e6e8e9",this.currentEl=null,this.initialize()}return a.prototype={constructor:a,filters:{cards:[],period:[]},initialize:function(){this.data=this.prepareData(this.parent.jsonData),this.drawGroupsAndCategories(this.data),this.handleSubGradeWidth(),this.changeCurrencies(),this.handleLiBoxNameWidth(),this.handleItemsColor(this.el.querySelectorAll(".categories_li._sub")),this.initIndicator=!1,this.bindEvents()},prepareData:function(a){for(var b={cashless:{categories:{}},refill:{categories:{}}},c=0,d=a.length;d>c;c++){var e=a[c].group;"cash"===e&&(e="cashless");var f=a[c].category,g=+a[c].cardSum.replace(/\s*/g,"").replace(/,/g,".");g=app.ext.tools.round(g,0),void 0===b[e].categories[f]?(b[e].categories[f]=[],b[e].categories[f].push(g)):b[e].categories[f][0]=app.ext.tools.round((100*b[e].categories[f][0]+100*g)/100,2)}return b=this.setTotalForGroups(b),b=this.setPercentValuesForCategories(b),b=this.setTitleForGroups(b),b=this.parseTotalToString(b),b=this.parseCateoryValuesToString(b),b=this.addGroupCssClass(b)},setTotalForGroups:function(a){for(var b in a)if(a.hasOwnProperty(b)){a[b].total=0;for(var c in a[b].categories)a[b].categories.hasOwnProperty(c)&&(a[b].total=app.ext.tools.round((100*a[b].total+100*a[b].categories[c][0])/100,2))}return a},setPercentValuesForCategories:function(a){for(var b in a){var c=[],d=[],e=0;if(a.hasOwnProperty(b)){for(var f in a[b].categories)a[b].categories.hasOwnProperty(f)&&(0===a[b].total?a[b].categories[f][1]=0:(a[b].categories[f][1]=a[b].categories[f][0]/a[b].total,a[b].categories[f][1]=app.ext.tools.round(a[b].categories[f][1],2),a[b].categories[f][1]=+(100*a[b].categories[f][1]).toFixed(),c.push(f),d.push(a[b].categories[f][1])));if(d.length>1){for(var g=0,h=d.length-1;h>g;g++)e+=d[g];a[b].categories[c[c.length-1]][1]=100-e}}}return a},setTitleForGroups:function(a){for(var b in a)a.hasOwnProperty(b)&&(a[b].title=this.parent.groupMap[b]);return a},parseTotalToString:function(a){for(var b in a)a.hasOwnProperty(b)&&(a[b].total=app.ext.tools.numToStr(a[b].total));return a},parseCateoryValuesToString:function(a){for(var b in a)if(a.hasOwnProperty(b))for(var c in a[b].categories)a[b].categories.hasOwnProperty(c)&&(a[b].categories[c][0]=app.ext.tools.numToStr(a[b].categories[c][0]));return a},addGroupCssClass:function(a){for(var b in a)a.hasOwnProperty(b)&&(a[b].cssClass=b);return a},drawGroupsAndCategories:function(a){var b=this.drawGroups(a);this.catIdCounter=0,this.grIdCounter=0,this.main.innerHTML="",this.main.appendChild(b)},drawGroups:function(a){var b=document.createElement("ul");b.className="categories_ul";var c="";for(var d in a)if(a.hasOwnProperty(d)){a[d].id=++this.grIdCounter,a[d].total=a[d].total.slice(0,-3),a[d].currency=app.cur,c=app.ext.tmp(document.getElementById("GroupItem").innerHTML)(a[d]),b.innerHTML+=c;var e=b.querySelector(".categories_li._"+a[d].cssClass),f=this.drawCategories(a,d),g=f.querySelectorAll(".categories_li._sub");0!==g.length&&g[g.length-1].classList.add("_last"),e.appendChild(f)}return b},drawCategories:function(a,b){a=a[b].categories;var c=document.createElement("ul");c.className="categories_ul";for(var d="",e=this.prepareDataArrayForCategories(a,b),f=0,g=e.length;g>f;f++)"0"===e[f].value&&(e[f].display="none"),d=app.ext.tmp(document.getElementById("CategoryItem").innerHTML)(e[f]),c.innerHTML+=d;return c},prepareDataArrayForCategories:function(a,b){var c=[];for(var d in a)if(a.hasOwnProperty(d)){var e=this.getGradeWidth(this.data[b].categories[d][1]),f=this.getCategoryIdByName(d),g=app.catColors[f],h={id:++this.catIdCounter,name:d,value:a[d][0].slice(0,-3),currency:app.cur,sortingValue:this.data[b].categories[d][0],gradeWidth:e,subgradeWidth:this.initIndicator?e:this.getSubgradeWidth(e,this.data[b].categories[d][0],a[d][0]),itemBg:g,display:"block"};c.push(h)}return this.parent.sortData(c,"sortingValue","sum",!0),c},getCategoryIdByName:function(a){for(var b in app.categories)if(app.categories.hasOwnProperty(b)&&app.categories[b]===a)return b},getGradeWidth:function(a){var b=238,c=b*(a/100);return app.ext.tools.round(c,0)},getSubgradeWidth:function(a,b,c){c=app.ext.tools.strToNum(c),b=app.ext.tools.strToNum(b);var d=a*(c/b);return d=app.ext.tools.round(d,0),(0===d||1===d)&&(d=2),d},redraw:function(a){for(var b=app.ext.tools.extendDeep(a,[]),c=0,d=b.length;d>c;c++)b[c]=this.passThroughCardsFilter(b[c]),b[c]=this.passThroughPeriodFilter(b[c]);var e=this.prepareData(b);this.saveDeactivatedCategories(),this.drawGroupsAndCategories(e),this.handleSubGradeWidth(),this.changeCurrencies(),this.handleLiBoxNameWidth(),this.restoreDeactivatedCategories(),this.handleItemsColor(this.el.querySelectorAll(".categories_li._sub")),this.deactivatedCategories=[],this.notifyAboutChanges()},passThroughPeriodFilter:function(a){var b=this.filters.period,c=b.length;if(0===c)return a;var d=app.ext.tools.strToDate(a.date,".").getTime();return d>=b[0].getTime()&&d<=b[1].getTime()?a:(a.cardSum="0,00",a)},passThroughCardsFilter:function(a){var b=this.filters.cards;if(0===b.length)return a;for(var c=0,d=b.length;d>c;c++){if(a.cardName===b[c].cardName&&a.cardNum.slice(15)===b[c].cardNum)return a.cardSum="0,00",a;if(c===d-1)return a}},handleLiBoxNameWidth:function(){for(var a=15,b=this.el.querySelectorAll(".categories_li-box"),c=0,d=b.length;d>c;c++)if("none"!==b[c].parentNode.style.display){var e=b[c],f=app.ext.tools.getStyle(e).paddingLeft.slice(0,-2),g=app.ext.tools.getStyle(e).paddingRight.slice(0,-2),h=e.querySelector(".categories_li-name"),i=e.querySelector(".categories_li-value"),j=e.clientWidth-f-g,k=h.clientWidth,l=i.clientWidth;0>j-k-l&&(h.style.width=j-l-a+"px")}},handleSubGradeWidth:function(){for(var a=this.el.querySelectorAll(".categories_li-subgrade"),b=0,c=a.length;c>b;b++)a[b].style.width=a[b].getAttribute("data-width")+"px"},changeCurrencies:function(){var a=this.el.querySelectorAll(".categories_li-cur");app.ext.tools.changeCurrencies(a)},notifyAboutChanges:function(){var a=this.getInactiveCategoriesArray();app.ext.pubsub.fireEvent("categories:changed",{categories:a})},getInactiveCategoriesArray:function(){for(var a=[],b=this.el.querySelectorAll(".categories_li._sub"),c=0,d=b.length;d>c;c++)if(!b[c].classList.contains("-active")){var e={group:"",category:""};e.group=app.ext.tools.closest(b[c],"_core").getAttribute("data-group"),e.category=b[c].querySelector(".categories_li-name").innerHTML,a.push(e)}return a},saveDeactivatedCategories:function(){for(var a=this.el.querySelectorAll(".categories_li"),b=0,c=a.length;c>b;b++)a[b].classList.contains("-active")||this.deactivatedCategories.push(a[b].getAttribute("data-id"))},restoreDeactivatedCategories:function(){for(var a=0,b=this.deactivatedCategories.length;b>a;a++){var c=this.el.querySelector('[data-id="'+this.deactivatedCategories[a]+'"]');c.classList.remove("-active")}},handleGroupState:function(a){var b=a.querySelectorAll(".categories_li._sub");this.checkIfAllCategoriesAreActive(b)?(this.deactivateSubCategories(b),a.classList.remove("-active")):(this.activateSubCategories(b),a.classList.add("-active"))},handleCategoryState:function(a){a.classList.toggle("-active");var b=app.ext.tools.closest(a,"_core"),c=b.querySelectorAll(".categories_li._sub");this.checkIfAllCategoriesAreActive(c)?b.classList.add("-active"):b.classList.remove("-active")},handleResetState:function(){var a=this.el.querySelectorAll(".categories_li._sub");this.checkIfAllCategoriesAreActive(a)&&(this.reset.innerHTML=this.en?"Reset":"Сбросить",this.reset.classList.remove("-reset")),this.checkIfAllCategoriesAreInactive(a)&&(this.reset.innerHTML=this.en?"Activate all":"Активировать все",this.reset.classList.add("-reset"))},checkIfAllCategoriesAreActive:function(a){for(var b=0,c=a.length;c>b;b++){if(!a[b].classList.contains("-active"))return!1;if(b===c-1)return!0}},checkIfAllCategoriesAreInactive:function(a){for(var b=0,c=a.length;c>b;b++){if(a[b].classList.contains("-active"))return!1;if(b===c-1)return!0}},activateSubCategories:function(a){"all"===a&&(a=this.el.querySelectorAll(".categories_li._sub"),this.activateAllCoreCategories());for(var b=0,c=a.length;c>b;b++)a[b].classList.add("-active")},deactivateSubCategories:function(a){"all"===a&&(a=this.el.querySelectorAll(".categories_li._sub"),this.deactivateAllCoreCategories());for(var b=0,c=a.length;c>b;b++)a[b].classList.remove("-active")},activateAllCoreCategories:function(){for(var a=this.el.querySelectorAll(".categories_li._core"),b=0,c=a.length;c>b;b++)a[b].classList.add("-active")},deactivateAllCoreCategories:function(){for(var a=this.el.querySelectorAll(".categories_li._core"),b=0,c=a.length;c>b;b++)a[b].classList.remove("-active")},activateOnlyOneCategoryByName:function(a){for(var b=this.el.querySelectorAll(".categories_li-name"),c=0,d=b.length;d>c;c++)b[c].innerHTML===a&&(app.ext.tools.closest(b[c],"categories_li").classList.add("-active"),app.ext.tools.closest(b[c],"_core").classList.remove("-active"))},handleItemsColor:function(a){for(var b=0,c=a.length;c>b;b++)this.handleItemColor(a[b])},handleItemColor:function(a,b){var c=a.getAttribute("data-item-bg"),d=a.querySelector(".categories_li-grade"),e=a.querySelector(".categories_li-subgrade-border"),f=a.querySelector(".categories_li-subgrade"),g=a.querySelector(".categories_li-full-width");a.classList.contains("-active")&&!b?(d.style.backgroundColor=f.style.backgroundColor=e.style.backgroundColor=c,g.style.backgroundColor=""):b&&"hover"===b?d.style.backgroundColor=f.style.backgroundColor=e.style.backgroundColor=g.style.backgroundColor=c:(d.style.backgroundColor=f.style.backgroundColor=e.style.backgroundColor=this.subgradeInactiveColor,g.style.backgroundColor="")},bindEvents:function(){app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickLiBox)),app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickLiReset)),app.ext.tools.addListener(this.el,"mouseover",app.ext.tools.bind(this,this.onmouseoverItem)),app.ext.tools.addListener(this.el,"mouseout",app.ext.tools.bind(this,this.onmouseoutItem)),app.ext.pubsub.addListener("cardsFilter:changed",app.ext.tools.bind(this,this.onCardsFilterChange)),app.ext.pubsub.addListener("period:changed",app.ext.tools.bind(this,this.onPeriodChange)),app.ext.pubsub.addListener("category:selected",app.ext.tools.bind(this,this.onCategorySelected))},onclickLiBox:function(a){var b=a||window.event,c=b.target||b.srcElement,d=app.ext.tools.closest(c,"categories_li");if(null!==d){var e=d;e.classList.contains("_core")?this.handleGroupState(e):e.classList.contains("_sub")&&this.handleCategoryState(e),this.handleResetState(),this.handleItemsColor(this.el.querySelectorAll(".categories_li._sub")),this.notifyAboutChanges()}},onclickLiReset:function(a){var b=a||window.event,c=b.target||b.srcElement;c.classList.contains("categories_reset")&&(c.classList.contains("-reset")?(this.activateSubCategories("all"),c.classList.remove("-reset"),c.innerHTML=this.en?"Reset":"Сбросить"):(this.deactivateSubCategories("all"),c.classList.add("-reset"),c.innerHTML=this.en?"Activate all":"Активировать все"),this.handleItemsColor(this.el.querySelectorAll(".categories_li._sub")),this.notifyAboutChanges())},onmouseoverItem:function(a){var b=a||window.event,c=b.target||b.srcElement;if(this.currentEl)return!1;for(;!(c==this.el||c.classList.contains("categories_li")&&c.classList.contains("_sub"));)c=c.parentNode;return c==this.el?!1:(this.currentEl=c,void this.handleItemColor(this.currentEl,"hover"))},onmouseoutItem:function(a){var b=a||window.event;if(b.relatedTarget=b.relatedTarget||b.toElement,!this.currentEl)return!1;var c=b.relatedTarget;if(c&&null!==app.ext.tools.closest(c,"b-categories"))for(;c!=this.el;){if(c==this.currentEl)return!1;c=c.parentNode}this.handleItemColor(this.currentEl),this.currentEl=null},onCardsFilterChange:function(a){this.filters.cards=a.cards,this.redraw(this.parent.jsonData)},onPeriodChange:function(a){this.filters.period=a.period,this.redraw(this.parent.jsonData)},onCategorySelected:function(a){var b=a.category;this.deactivateSubCategories("all"),this.activateOnlyOneCategoryByName(b),this.handleItemsColor(this.el.querySelectorAll(".categories_li._sub")),this.notifyAboutChanges()}},{init:function(){var b=document.querySelector(".b-categories");null!==b&&(app.module.categories=new a({el:b,parent:app.module.history}))}}}),app.register("module","search",function(){function a(a){this.el=a.el,this.parent=a.parent,this.loupeIcon=this.el.querySelector(".search_loupe"),this.cancelIcon=this.el.querySelector(".search_cancel"),this.tokenBox=this.el.querySelector(".search_token-box"),this.inputBox=this.el.querySelector(".search_input-box"),this.inputBoxLPadding=parseInt(app.ext.tools.getStyle(this.inputBox).paddingLeft),this.inputBoxRPadding=parseInt(app.ext.tools.getStyle(this.inputBox).paddingRight),this.inputBoxPadding=this.inputBoxLPadding+this.inputBoxRPadding,this.input=this.el.querySelector(".search_input"),this.label=this.el.querySelector(".search_label"),this.inputSizer=this.el.querySelector(".search_input-sizer"),this.delimiter=",",this.minInputBoxWidth=100,this.inputSymbolFund=20,this.initialize()}return a.prototype={constructor:a,initialize:function(){this.bindEvents()},goToInput:function(){this.label.style.display="none",this.input.focus()},setNewTokenIfInputValueExists:function(){var a=this.input.value;if(a.length>0){var b=this.createToken(a);this.addToken(b),this.showTokenBoxIfHidden(),this.clearInputValue(),this.setInputBoxMinWidth(),this.showSearchCancelIcon(),this.notifyAboutChanges(this.getTokensTexts())}else this.showLabel()},addToken:function(a){var b=this.tokenBox.querySelector(".search_token");null!==b?this.tokenBox.insertBefore(a,b):this.tokenBox.appendChild(a)},createToken:function(a){var b=document.createElement("a");b.href="#",b.className="search_token";var c=document.createElement("span");c.className="search_token-text",c.innerHTML=app.ext.tools.trim(a);var d=document.createElement("span");return d.className="search_token-icon",b.appendChild(c),b.appendChild(d),b},removeTokens:function(a){for(var b=[],c=0,d=a.length;d>c;c++)a[c].classList.contains("_shortcut")&&b.push(app.ext.tools.trim(a[c].querySelector(".search_token-text").innerHTML)),a[c].parentNode.removeChild(a[c]);this.notifyAboutChanges(this.getTokensTexts()),app.ext.pubsub.fireEvent("shortcuts:remove",{shortcutsNames:b}),this.hideSearchCancellationIfNoTokens()},getTokensTexts:function(){var a=this.tokenBox.querySelectorAll(".search_token .search_token-text");if(a.length){for(var b="",c=0,d=a.length;d>c;c++)a[c].parentNode.classList.contains("_shortcut")||(b+=a[c].innerHTML+this.delimiter+" ");return b}return""},getActiveTokens:function(){return this.el.querySelectorAll(".search_token.-active")},showTokenBoxIfHidden:function(){"block"!==this.tokenBox.style.display&&(this.tokenBox.style.display="block",this.setInputBoxMinWidth())},hideTokenBoxIfEmpty:function(){null===this.tokenBox.querySelector(".search_token")&&(this.tokenBox.style.display="",this.inputBox.style.width="100%")},showLabel:function(){this.label.style.display="block"},clearInputValue:function(){this.input.value=""},setInputBoxMinWidth:function(){this.inputBox.style.width=this.minInputBoxWidth+"px",this.tokenBox.style.marginLeft=this.minInputBoxWidth+"px"},showSearchCancelIcon:function(){"block"!==this.cancelIcon.style.display&&(this.cancelIcon.style.display="block")},hideSearchCancellationIfNoTokens:function(){0==this.el.querySelectorAll(".search_token").length&&(this.cancelIcon.style.display="none")},handleInputWidth:function(){this.inputSizer.innerHTML=this.input.value;var a=this.inputSizer.clientWidth+this.inputSymbolFund;if(this.minInputBoxWidth>=a+this.inputBoxPadding)this.inputBox.style.width=this.minInputBoxWidth+"px",this.tokenBox.style.marginLeft=this.minInputBoxWidth+"px";else{var b=a+this.inputBoxPadding;this.inputBox.style.width=b+"px",this.tokenBox.style.marginLeft=b+"px"}},notifyAboutChanges:function(a){app.ext.pubsub.fireEvent("search:changed",{text:a})},bindEvents:function(){app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickLabel)),app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickSearchIcon)),app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickTokenBox)),app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickToken)),app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickTokenCross)),app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickSearchCancel)),app.ext.tools.addListener(this.el,"keydown",app.ext.tools.bind(this,this.onkeydownInput)),app.ext.tools.addListener(this.el,"keypress",app.ext.tools.bind(this,this.onkeypressInput)),app.ext.tools.addListener(this.el,"keyup",app.ext.tools.bind(this,this.onkeyupInput)),app.ext.tools.addListener(app.el,"keydown",app.ext.tools.bind(this,this.onkeydownApp)),app.ext.tools.addListener(app.el,"keyup",app.ext.tools.bind(this,this.onkeyupApp)),app.ext.tools.delegateFocus(this.el,app.ext.tools.bind(this,this.onfocusInput)),app.ext.tools.delegateBlur(this.el,app.ext.tools.bind(this,this.onblurInput)),app.ext.pubsub.addListener("search:add-shortcut",app.ext.tools.bind(this,this.addShortcut))},onclickLabel:function(a){var b=a||window.event,c=b.target||b.srcElement,d=app.ext.tools.closest(c,"search_label");(c.classList.contains("search_label")||null!==d)&&this.goToInput()},onclickSearchIcon:function(a){var b=a||window.event,c=b.target||b.srcElement;c.classList.contains("search_icon")&&this.goToInput()},onfocusInput:function(a){var b=a||window.event,c=b.target||b.srcElement;c.classList.contains("search_input")&&this.loupeIcon.classList.add("-active")},onblurInput:function(a){var b=a||window.event,c=b.target||b.srcElement;c.classList.contains("search_input")&&(this.setNewTokenIfInputValueExists(),this.loupeIcon.classList.remove("-active"))},onclickTokenBox:function(a){var b=a||window.event,c=b.target||b.srcElement,d=app.ext.tools.closest(c,"search_token-box");if(c.classList.contains("search_token-box")||null!==d){if(app.ext.tools.closest(c,"search_token"))return!1;this.goToInput()}},onclickToken:function(a){var b=a||window.event,c=b.target||b.srcElement,d=app.ext.tools.closest(c,"search_token");(c.classList.contains("search_token")||null!==d)&&(b.preventDefault?b.preventDefault():b.returnValue=!1,d&&(c=d),c.classList.toggle("-active"))},onclickTokenCross:function(a){var b=a||window.event,c=b.target||b.srcElement;c.classList.contains("search_token-icon")&&(this.removeTokens([app.ext.tools.closest(c,"search_token")]),this.hideTokenBoxIfEmpty())},onclickSearchCancel:function(a){var b=a||window.event,c=b.target||b.srcElement;if(c.classList.contains("search_cancel")){var d=this.el.querySelectorAll(".search_token");this.removeTokens(d),this.hideTokenBoxIfEmpty(),this.activeTokensExists=!1}},onkeydownInput:function(a){var b=a||window.event,c=b.target||b.srcElement;c.classList.contains("search_input")&&this.handleInputWidth()},onkeypressInput:function(a){var b=a||window.event,c=b.target||b.srcElement;c.classList.contains("search_input")},onkeyupInput:function(a){var b=a||window.event,c=b.target||b.srcElement;c.classList.contains("search_input")&&(32==b.keyCode&&(this.input.value=this.input.value.replace(/^\s+/,"")),this.handleInputWidth(),13==b.keyCode&&this.setNewTokenIfInputValueExists())},onkeydownApp:function(a){var b=a||window.event;(8==b.keyCode||46==b.keyCode)&&(this.activeTokens=this.getActiveTokens(),this.activeTokens.length>0&&(b.preventDefault?b.preventDefault():b.returnValue=!1,this.activeTokensExists=!0))},onkeyupApp:function(a){var b=a||window.event;(8==b.keyCode||46==b.keyCode)&&this.activeTokensExists&&(this.removeTokens(this.activeTokens),this.hideTokenBoxIfEmpty(),this.activeTokensExists=!1)},addShortcut:function(a){var b=this.createToken(a.name);b.classList.add("_shortcut"),this.addToken(b),this.showTokenBoxIfHidden(),this.clearInputValue(),this.setInputBoxMinWidth(),this.showSearchCancelIcon()}},{init:function(){var b=document.querySelector(".b-search");null!==b&&(app.module.search=new a({el:b,parent:app.module.history}))}}}),app.register("module","trs",function(){function a(a){this.el=a.el,this.parent=a.parent,this.en=app.en,this.initIndicator=!0,this.initialize()}return a.prototype={constructor:a,filters:{search:"",categories:[],cards:[],period:[],shortcuts:[]},initialize:function(){this.data=this.prepareData(),this.drawHistory(this.data),this.bindEvents(),this.initIndicator=!1},getCategoryNum:function(a){a=a.toLowerCase();for(var b in app.categories)if(app.categories.hasOwnProperty(b)&&app.categories[b].toLowerCase()==a)return b},prepareData:function(){for(var a=app.ext.tools.extendDeep(this.parent.jsonData,[]),b=0,c=a.length;c>b;b++){a[b].cardFullSum=a[b].cardSum;var d=a[b].cardSum.slice(0,-3),e=a[b].cardSum.slice(-3);a[b].cardSum=d,a[b].cardSumFr=e,a[b].dateOriginal=a[b].date,a[b].postDateOriginal=a[b].postDate,a[b].date=this.prepareDates(a[b].date),a[b].postDate=this.prepareDates(a[b].postDate),a[b].bgColor=app.catColors[this.getCategoryNum(a[b].category)]}return a},prepareDates:function(a){return a=a.slice(0,-2)+"20"+a.slice(-2),a=this.en?app.ext.tools.dateStrToStrWithFullMonth(a,"en"):app.ext.tools.dateStrToStrWithFullMonth(a,"ru"),"0"===a.charAt(0)&&(a=a.slice(1)),a=this.cutCurrentYear(a)},getDataItemById:function(a){for(var b=0,c=this.data.length;c>b;b++){if(this.data[b].id===a)return app.ext.tools.extendDeep(this.data[b]);if(b===c-1)return null}},cutCurrentYear:function(a){var b=(new Date).getFullYear()+"",c=a.slice(-4);return b===c&&(a=this.en?app.ext.tools.trim(a.slice(0,-6)):app.ext.tools.trim(a.slice(0,-4))),a},drawHistory:function(a){for(var b=document.createDocumentFragment(),c=[],d=0,e=a.length;e>d;d++){var f;if(f=this.initIndicator?a[d]:this.passThroughFilters(a[d])){c.push(f);var g=this.drawHistoryItem(a[d]);b.appendChild(g)}}app.ext.pubsub.fireEvent("shortcuts:redraw",{data:c}),this.el.innerHTML="",this.el.appendChild(b),this.changeCurrencies()},drawHistoryItem:function(a){var b=document.createElement("div");return b.id=a.id,b.className="trs_it _"+a.group,b.innerHTML=app.ext.tmp(document.getElementById("HistoryItemMain").innerHTML)(a),b},passThroughFilters:function(a){var b;return(b=this.passThroughPeriodFilter(a))&&(b=this.passThroughCategoriesFilter(a))&&(b=this.passThroughSearchFilter(a))&&(b=this.passThroughCardsFilter(a))?(b=this.passThroughShortcutsFilter(a),b?a:!1):!1},passThroughPeriodFilter:function(a){var b=this.filters.period,c=b.length;if(0===c)return!0;var d=app.ext.tools.strToDate(a.dateOriginal,".").getTime();return!!(d>=b[0].getTime()&&d<=b[1].getTime())},passThroughCategoriesFilter:function(a){var b=this.filters.categories,c=b.length;if(0===c)return!0;for(var d=0;c>d;d++){if(a.category===b[d].category)return!1;if(d===c-1)return!0}},passThroughSearchFilter:function(a){var b=this.filters.search,c=b.replace(/,\s/g,",").split(","),d=this.prepareDataItemForSearch(a),e=this.prepareDataItemFieldsArray(d);a:for(var f=0,g=c.length;g>f;f++)for(var h=0,i=e.length;i>h;h++)if(null!=d[e[h]]){if("country"===e[h]&&this.tryToFindStrInCountriesAr(d[e[h]],c[f])){if(f!==g-1)continue a;return!0}if("city"===e[h]&&this.tryToFindStrInCitiesAr(d[e[h]],c[f])){if(f!==g-1)continue a;return!0}if(-1!==d[e[h]].toLowerCase().indexOf(c[f].toLowerCase())){if(f!==g-1)continue a;return!0}if(h===i-1)return!1}},passThroughShortcutsFilter:function(a){var b=this.filters.shortcuts;if(0===b.length)return!0;for(var c=0,d=b.length;d>c;c++){if(a.id===b[c])return!0;if(c===d-1)return!1}},prepareDataItemForSearch:function(a){return a.cardTypeSearch="O"===a.cardType?"Основная":"Дополнительная",a.groupSearch=this.parent.groupMap[a.group],a.cardFullSumSearch=a.cardFullSum.replace(/\s+/g,""),a.frnSumSearch=a.frnSum.replace(/\s+/g,""),a.frnCurSearch=app.ext.tools.cur[a.frnCur.toLowerCase()]||"",a},prepareDataItemFieldsArray:function(a){var b=[];for(var c in a)if(a.hasOwnProperty(c)){if("id"===c)continue;b.push(c)}return b},tryToFindStrInCountriesAr:function(a,b){if(-1!==a.toLowerCase().indexOf(b.toLowerCase()))return!0;var c=app.countries[a.toUpperCase()];if(!c)return!1;for(var d=0,e=c.length;e>d;d++){if(-1!==c[d].toLowerCase().indexOf(b.toLowerCase()))return!0;if(d===e-1)return!1}},tryToFindStrInCitiesAr:function(a,b){if(-1!==a.toLowerCase().indexOf(b.toLowerCase()))return!0;var c=this.findCityAr(a);if(!c)return!1;for(var d=0,e=c.length;e>d;d++){if(-1!==c[d].toLowerCase().indexOf(b.toLowerCase()))return!0;
if(d===e-1)return!1}},findCityAr:function(a){for(var b=app.cities,c=0,d=b.length;d>c;c++){for(var e=0,f=b[c].length;f>e;e++)if(b[c][e].toLowerCase()===a.toLowerCase())return b[c];if(c===d-1)return!1}},passThroughCardsFilter:function(a){var b=this.filters.cards,c=b.length;if(0===c)return!0;for(var d=0,e=b.length;e>d;d++){if(a.cardName===b[d].cardName&&a.cardNum.slice(15)===b[d].cardNum)return!1;if(d===e-1)return!0}},drawHistorySecItem:function(a){var b=this.getDataItemById(a.id),c=app.countries[b.country.toUpperCase()];c&&(b.country=c[0]);var d=this.findCityAr(b.city);d&&(b.city=d[0]),b=this.prepareDataItem(b);var e=document.createElement("div");e.className="trs_it-sec",e.innerHTML=app.ext.tmp(document.getElementById("HistoryItemSecondary").innerHTML)(b),a.appendChild(e)},prepareDataItem:function(a){return a.cardType="O"===a.cardType?this.en?"primary":"основная":this.en?"additional":"дополнительная",a.cardNum=a.cardNum.slice(12).replace(/X/g,"&bull;"),a},changeCurrencies:function(){var a=this.el.querySelectorAll(".trs_it-cur");app.ext.tools.changeCurrencies(a)},bindEvents:function(){app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickHistoryItem)),app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickCategoryName)),app.ext.pubsub.addListener("categories:changed",app.ext.tools.bind(this,this.onCategoriesChange)),app.ext.pubsub.addListener("search:changed",app.ext.tools.bind(this,this.onSearchChange)),app.ext.pubsub.addListener("cardsFilter:changed",app.ext.tools.bind(this,this.onCardsFilterChange)),app.ext.pubsub.addListener("period:changed",app.ext.tools.bind(this,this.onPeriodChange)),app.ext.pubsub.addListener("shortcuts:changed",app.ext.tools.bind(this,this.onShortcutsChange))},onclickHistoryItem:function(a){var b=a||window.event,c=b.target||b.srcElement,d=app.ext.tools.closest(c,"trs_it-main");if(c.classList.contains("trs_it-main")||null!==d){d&&(c=d);var e,f=c.parentNode;e=c.parentNode.querySelector(".trs_it-sec"),f.classList.contains("-active")?(f.classList.remove("-active"),e.style.display="none"):(f.classList.add("-active"),e?e.style.display="block":(this.drawHistorySecItem(c.parentNode),e=c.parentNode.querySelector(".trs_it-sec"),e.style.display="block"))}},onclickCategoryName:function(a){var b=a||window.event,c=b.target||b.srcElement;c.classList.contains("trs_it-cat-name")&&(app.ext["browser-type"].ie8&&app.ext.tools.closest(c,"trs_it").classList.contains("-active")||!app.ext["browser-type"].ie8&&!app.ext.tools.closest(c,"trs_it").classList.contains("-active"))&&app.ext.pubsub.fireEvent("category:selected",{category:c.innerHTML})},onCategoriesChange:function(a){this.filters.categories=a.categories,this.drawHistory(this.data)},onSearchChange:function(a){this.filters.search=a.text,this.drawHistory(this.data)},onCardsFilterChange:function(a){this.filters.cards=a.cards,this.drawHistory(this.data)},onPeriodChange:function(a){this.filters.period=a.period,this.drawHistory(this.data)},onShortcutsChange:function(a){this.filters.shortcuts=a.filter,this.drawHistory(this.data)}},{init:function(){var b=document.querySelector(".b-trs");null!==b&&(app.module.trs=new a({el:b,parent:app.module.history}))}}}),app.register("module","cards-filter",function(){function a(a){this.el=a.el,this.parent=a.parent,this.title=this.el.querySelector(".cards-filter_title"),this.en=app.en,this.cardsLength=null,this.itemsWithoutScroll=6,this.initialize()}return a.prototype={constructor:a,initialize:function(){this.getMaxDate(),this.data=this.prepareData(),this.drawCardsFilter(this.data),this.bindEvents()},getMaxDate:function(){this.dateMax=app.periodEndDate},prepareData:function(){for(var a=this.parent.jsonData,b=[],c={},d=0,e=0,f=a.length;f>e;e++)c[a[e].cardNum]={cardType:a[e].cardType,cardName:a[e].cardName};for(var g in c)if(c.hasOwnProperty(g)){d++;var h={};h.cardId="Card"+d,h.cardName=c[g].cardName,h.cardBlocked=this.checkIfCardIsBlocked(c[g].cardName,g),h.cardNum=g.slice(12).replace(/X/g,"&bull;"),h.cardType="O"===c[g].cardType?"Основная":"Дополнительная",b.push(h)}return b},checkIfCardIsBlocked:function(a,b){b=b.replace(/\s+/g,"").replace(/X/g,"");var c=app.blockedCards;if(!c)return!1;for(var d=0,e=c.length;e>d;d++)if(c[d].cardName===a&&c[d].cardNumber===b)return!0;return!1},drawCardsFilter:function(a){1===a.length?(this.el.classList.add("_single"),this.title.innerHTML="по карте "+a[0].cardNum,this.title.style.cssText="border-bottom: 0; cursor: default"):(this.dropdown=this.drawCardsFilterDropdown(a),this.el.appendChild(this.dropdown),this.items=this.el.querySelectorAll(".cards-filter_item"),this.checkboxes=this.el.querySelectorAll(".cards-filter_checkbox"),this.switcher=this.el.querySelector(".cards-filter_switcher"),this.switcherText=this.el.querySelector(".cards-filter_switcher-text"))},drawCardsFilterDropdown:function(a){var b=document.createElement("div");b.className="cards-filter_dropdown",b.innerHTML=document.getElementById("CardsFilterDropdown").innerHTML;var c=b.querySelector(".cards-filter_items-wrapper");return c.innerHTML=this.drawCardsFilterDropdownItems(a),b},drawCardsFilterDropdownItems:function(a){for(var b="",c=a.length,d=0;c>d;d++)b+=app.ext.tmp(document.getElementById("CardsFilterItem").innerHTML)(a[d]);return this.cardsLength=c,b},notifyAboutChanges:function(a){app.ext.pubsub.fireEvent("cardsFilter:changed",{cards:a})},changeTitle:function(a){a.length===this.data.length?this.title.innerHTML=this.en?"by all cards":"по всем картам":a.length>6?this.title.innerHTML=this.en?"by "+a.length+" cards":"по "+a.length+" картам":5===a.length?this.title.innerHTML=this.en?"by five cards":"по пяти картам":4===a.length?this.title.innerHTML=this.en?"by four cards":"по четырем картам":3===a.length?this.title.innerHTML=(this.en?"by cards ":"по картам: ")+"&bull;&bull;&nbsp;"+a[0].cardNum+", &bull;&bull;&nbsp;"+a[1].cardNum+" и &bull;&bull;&nbsp;"+a[2].cardNum:2===a.length?this.title.innerHTML=(this.en?"by cards ":"по картам: ")+"&bull;&bull;&nbsp;"+a[0].cardNum+" и &bull;&bull;&nbsp;"+a[1].cardNum:1===a.length?this.title.innerHTML=(this.en?"by card ":"по карте: ")+"&bull;&bull;&nbsp;"+a[0].cardNum:0===a.length&&(this.title.innerHTML=this.en?"... ups, select the card :)":"... ой, выберите карту :)")},scanForActiveCards:function(){for(var a=[],b=this.checkboxes,c=0,d=b.length;d>c;c++)if(b[c].checked===!0){var e={cardName:b[c].parentNode.querySelector(".cards-filter_card-name").innerHTML,cardNum:b[c].parentNode.querySelector(".cards-filter_card-num").innerHTML.slice(3)};a.push(e)}return a},scanForInactiveCards:function(){for(var a=[],b=this.checkboxes,c=0,d=b.length;d>c;c++)if(b[c].checked===!1){var e={cardName:b[c].parentNode.querySelector(".cards-filter_card-name").innerHTML,cardNum:b[c].parentNode.querySelector(".cards-filter_card-num").innerHTML.slice(3)};a.push(e)}return a},handleSwitcherState:function(a){var b=a.length;b<this.cardsLength?(this.switcher.classList.add("_check-all"),this.switcherText.innerHTML=this.en?"Check all":"Выбрать все"):b===this.cardsLength&&(this.switcher.classList.remove("_check-all"),this.switcherText.innerHTML=this.en?"Reset all":"Сбросить выбор")},showDropdown:function(){this.dropdown.style.display="block",this.handleDropdownScroll(),app.ext.pubsub.fireEvent("close-other-dropdowns",{id:this.el.id}),app.historyDropdownOpened=!0},hideDropdown:function(){void 0!==this.dropdown&&(this.dropdown.style.display="block")&&(this.dropdown.style.display="none",this.dropdown.style.width="",this.el.querySelector(".cards-filter_title").classList.remove("-active")),app.historyDropdownOpened=!1},handleDropdownScroll:function(){var a=this.el.querySelector(".cards-filter_items-wrapper"),b=this.el.querySelectorAll(".cards-filter_item "),c=b.length;if(c>this.itemsWithoutScroll){var d=b[0].offsetHeight;a.style.height=d*this.itemsWithoutScroll+"px",a.style.overflow="auto",this.incDropdownWidth()}},incDropdownWidth:function(){var a=app.ext.tools.scrollBarWidth,b=this.el.querySelector(".cards-filter_dropdown");b.style.width=b.clientWidth+a+"px"},activateAllItems:function(){for(var a=0,b=this.items.length;b>a;a++)this.items[a].classList.add("-active"),this.checkboxes[a].checked=!0},deactivateAllItems:function(){for(var a=0,b=this.items.length;b>a;a++)this.items[a].classList.remove("-active"),this.checkboxes[a].checked=!1},bindEvents:function(){app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickTitle)),app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickCheckbox)),app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickSwitcher)),app.ext.tools.addListener(app.el,"click",app.ext.tools.bind(this,this.hideDropdown)),app.ext.pubsub.addListener("close-other-dropdowns",app.ext.tools.bind(this,this.onCloseOtherDropdowns))},onclickTitle:function(a){var b=a||window.event;b.stopPropagation?b.stopPropagation():b.cancelBubble=!0;var c=b.target||b.srcElement;if(c.classList.contains("cards-filter_title")){if(this.el.classList.contains("_single"))return!1;c.classList.contains("-active")||c.classList.add("-active"),this.showDropdown()}},onclickCheckbox:function(a){var b=a||window.event,c=b.target||b.srcElement;if(c.classList.contains("cards-filter_checkbox")){c.parentNode.classList.toggle("-active");var d=this.scanForActiveCards(),e=this.scanForInactiveCards();this.handleSwitcherState(d),this.changeTitle(d),this.notifyAboutChanges(e)}},onclickSwitcher:function(a){var b=a||window.event,c=b.target||b.srcElement,d=app.ext.tools.closest(c,"cards-filter_switcher");if(c.classList.contains("cards-filter_switcher")||null!==d){d&&(c=d),c.classList.contains("_check-all")?(c.classList.remove("_check-all"),this.switcherText.innerHTML="Сбросить выбор",this.activateAllItems()):(c.classList.add("_check-all"),this.switcherText.innerHTML="Выбрать все",this.deactivateAllItems());var e=this.scanForActiveCards(),f=this.scanForInactiveCards();this.changeTitle(e),this.notifyAboutChanges(f)}},onCloseOtherDropdowns:function(a){return a.id===this.el.id?!1:void this.hideDropdown()}},{init:function(){var b=document.querySelector(".b-cards-filter");null!==b&&(app.module.cardsFilter=new a({el:b,parent:app.module.history}))}}}),app.register("module","chart",function(){function a(a){this.el=a.el,this.parent=a.parent,this.chartWrapper=this.el.querySelector(".chart_chart-wrapper"),this.balanceStartNum=app.ext.tools.strToNum(app.el.querySelector("#BalanceStartNum").innerHTML),this.en=app.en,this.maxRefR=6,this.refPadding=10,this.maxExpBalH=35,this.brushH=24,this.chartH=2*this.maxRefR+this.refPadding+this.maxExpBalH,this.svgH=this.chartH+this.brushH,this.leftIndent=10,this.rightIndent=10,this.brushExtent=[],this.enteredResizeEl=!1,this.brushing=!1,this.alertContentReversed=!1,this.initialize()}return a.prototype={constructor:a,filters:{cards:[]},initialize:function(){return this.setPeriod(),this.definePeriodLength(),this.data=this.prepareData(this.parent.jsonData,!1),this.balanceData=this.prepareData(this.parent.jsonData,!0),this.data.length<2?(this.el.parentNode.removeChild(this.el),!1):(this.setD3Localization(),this.addSvg(),this.prepareChart(this.data),this.styleChart(this.data,this.xScale,this.yScalesObj),this.addBrush(this.xScale,this.timeAxis,this.chartDateMin,this.chartDateMax),this.incSvgIfMinusBalance(this.data,this.yScalesObj),void this.bindEvents())},setD3Localization:function(){var a={decimal:",",thousands:" ",grouping:[3],currency:[""," руб."],dateTime:"%A, %e %B %Y г. %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],shortDays:["вс","пн","вт","ср","чт","пт","сб"],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],shortMonths:["ЯНВ","ФЕВ","МАР","АПР","МАЙ","ИЮН","ИЮЛ","АВГ","СЕН","ОКТ","НОЯ","ДЕК"]};this.ru=d3.locale(a)},setPeriod:function(){this.dateMin=app.periodStartDate,this.dateMax=app.periodEndDate},definePeriodLength:function(){var a=(this.dateMax.getTime()-this.dateMin.getTime())/864e5/31;this.lessThanAMonth=1>a,this.moreThanAMonth=a>=1&&12>=a,this.moreThanAYear=a>12},prepareData:function(a,b){var c=app.ext.tools.extendDeep(a,[]);b?this.parent.sortData(c,"postDate","date",!1):this.parent.sortData(c,"date","date",!1),b||(c=this.excludeDeviationDates(c));var d=this.transformOriginalDataPerDay(c,b);return d=this.addBalanceToData(d),d=this.parseStrDate(d),d=this.addStartEndObjIfNeed(d)},excludeDeviationDates:function(a){for(var b=[],c=0,d=a.length;d>c;c++)a[c].showDate||b.push(a[c]);return b},transformOriginalDataPerDay:function(a,b){for(var c=[],d={date:"",expense:0,refill:0,balance:0},e=0,f=a.length;f>e;e++){var g,h=b?a[e].postDate:a[e].date;g=this.moreThanAYear?"01."+h.slice(3):h,e>0?(g===d.date?d=this.sumDataItemGroups(d,a[e]):(c.push(d),d={date:"",expense:0,refill:0,balance:0},d.date=g,d=this.sumDataItemGroups(d,a[e])),e===a.length-1&&c.push(d)):(d.date=g,d=this.sumDataItemGroups(d,a[e]))}return c},sumDataItemGroups:function(a,b){var c=app.ext.tools.strToNum(b.cardSum);return"refill"===b.group&&(a.refill=app.ext.tools.round((100*a.refill+100*c)/100,2)),"cash"===b.group&&(a.expense=app.ext.tools.round((100*a.expense+100*c)/100,2)),"cashless"===b.group&&(a.expense=app.ext.tools.round((100*a.expense+100*c)/100,2)),a},addBalanceToData:function(a){for(var b=this.balanceStartNum,c=0,d=a.length;d>c;c++)0===c?a[c].balance=app.ext.tools.round((100*b-100*a[c].expense+100*a[c].refill)/100,2):a[c].balance=app.ext.tools.round((100*a[c-1].balance-100*a[c].expense+100*a[c].refill)/100,2);return a},parseStrDate:function(a){for(var b=0,c=a.length;c>b;b++)a[b].date=app.ext.tools.strToDate(a[b].date,".");return a},addStartEndObjIfNeed:function(a){return this.moreThanAYear?((a[0].date.getFullYear()!==this.dateMin.getFullYear()||a[0].date.getMonth()!==this.dateMin.getMonth())&&(a.unshift({balance:this.balanceStartNum,date:this.dateMin,expense:0,refill:0}),this.addStartEndObj=!0),(a[a.length-1].date.getFullYear()!==this.dateMin.getFullYear()||a[a.length-1].date.getMonth()!==this.dateMin.getMonth())&&(a.push({balance:a[a.length-1].balance,date:this.dateMax,expense:0,refill:0}),this.addStartEndObj=!0)):(a[0].date.getTime()!==this.dateMin.getTime()&&a.unshift({balance:this.balanceStartNum,date:this.dateMin,expense:0,refill:0}),a[a.length-1].date.getTime()!==this.dateMax.getTime()&&a.push({balance:a[a.length-1].balance,date:this.dateMax,expense:0,refill:0})),a},prepareFilteredData:function(a){for(var b=app.ext.tools.extendDeep(a,[]),c=0,d=b.length;d>c;c++)b[c]=this.passThroughCardsFilter(b[c]);var e=this.prepareData(b);this.data=this.prepareData(a);for(var f=0,g=this.data.length;g>f;f++)this.data[f].expense=e[f].expense},passThroughCardsFilter:function(a){var b=this.filters.cards;if(0===b.length)return a;for(var c=0,d=b.length;d>c;c++){if(a.cardName===b[c].cardName&&a.cardNum.slice(15)===b[c].cardNum)return("cash"===a.group||"cashless"===a.group)&&(a.cardSum="0,00"),a;if(c===d-1)return a}},addSvg:function(){d3.select(".chart_chart-wrapper").append("svg").attr({width:this.leftIndent+this.chartWrapper.clientWidth+this.rightIndent+"px",height:this.svgH+"px","class":"chart_svg"}).style({margin:"0 -10px"}),this.D3svg=d3.select(".chart_svg")},prepareChart:function(a){this.addSvgElsAndBindData(a),this.yScalesObj=this.setYScales(a),this.xScale=this.setXScale(),this.addTimeAxis(this.xScale)},addSvgElsAndBindData:function(a){this.addGradForBalanceLine(this.D3svg),this.addBalance(this.D3svg,this.balanceData),this.addExpense(this.D3svg,a),this.addRefill(this.D3svg,a)},addGradForBalanceLine:function(a){a.append("linearGradient").attr("id","BalanceGrad").attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2","100%").selectAll("stop").data([{offset:"0%",color:"#d8dadc"},{offset:"60%",color:"#d8dadc"},{offset:"60%",color:"#ddcc65"},{offset:"70%",color:"#ddcc65"},{offset:"100%",color:"red"}]).enter().append("stop").attr("offset",function(a){return a.offset}).attr("stop-color",function(a){return a.color})},addExpense:function(a,b){a.selectAll("rect.expense").data(b).enter().append("rect").attr("class","expense"),this.removeWithoutData(d3.selectAll("rect.expense")[0],"expense")},addBalance:function(a,b){this.addStartEndObj||this.addDataItemForBalanceLineEnd(b),a.selectAll("rect.balance").data(b).enter().append("rect").attr("class","balance"),this.removeWithoutData(d3.selectAll("rect.balance")[0],"balance")},addDataItemForBalanceLineEnd:function(a){var b={};b.date=a[a.length-1].date,b.date=new Date(b.date.getTime()+(this.moreThanAYear?2592e6:864e5)-1),b.expense=a[a.length-1].expense,b.refill=a[a.length-1].refill,b.balance=a[a.length-1].balance,a.push(b)},addRefill:function(a,b){a.selectAll("circle.refill").data(b).enter().append("circle").attr("class","refill"),this.removeWithoutData(d3.selectAll("circle.refill")[0],"refill"),a.append("path").attr({"class":"balance-line"}).style({fill:"none",stroke:"#d8dadc","stroke-width":"1px"})},removeWithoutData:function(a,b){for(var c=0,d=a.length;d>c;c++)0===a[c].__data__[b]&&a[c].parentNode.removeChild(a[c])},setYScales:function(a){var b=d3.max(a,function(a){return a.expense}),c=d3.max(this.balanceData,function(a){return Math.abs(a.balance)}),d=d3.max(a,function(a){return a.refill}),e=d3.scale.linear().domain([0,b]).range([2,this.maxExpBalH]),f=d3.scale.linear().domain([0,c]).range([0,this.maxExpBalH]),g=d3.scale.linear().domain([0,d]).range([2,this.maxRefR]);return{expenseYScale:e,balanceYScale:f,refillYScale:g}},setXScale:function(){if(this.moreThanAYear){this.chartDateMin=new Date(this.dateMin.getFullYear(),this.dateMin.getMonth(),1);var a=new Date(this.dateMax.getFullYear(),this.dateMax.getMonth()+1,0);this.addStartEndObj?this.chartDateMax=this.dateMax:this.chartDateMax=new Date(this.dateMax.getTime()+(a.getTime()-this.dateMax.getTime())-1)}else this.chartDateMin=this.dateMin,this.chartDateMax=new Date(this.dateMax.getTime()+864e5-1);return d3.time.scale().domain([this.chartDateMin,this.chartDateMax]).range([0+this.leftIndent,this.chartWrapper.clientWidth+this.leftIndent])},addTimeAxis:function(a){var b,c;this.moreThanAMonth?(b=d3.time.format.multi([["%b",function(a){return 0!=a.getMonth()}],["%b %Y",function(){return!0}]]),c=this.ru.timeFormat.multi([["%b",function(a){return 0!=a.getMonth()}],["%b %Y",function(){return!0}]]),this.timeAxis=d3.svg.axis().scale(a).orient("bottom").ticks(d3.time.months).tickFormat(this.en?b:c)):this.moreThanAYear?this.timeAxis=d3.svg.axis().scale(a).orient("bottom").ticks(d3.time.years).tickFormat(this.en?d3.time.format("%Y"):this.ru.timeFormat("%Y")):(b=d3.time.format.multi([["%e",function(a){return 1!=a.getDate()}],["%e %b",function(){return!0}]]),c=this.ru.timeFormat.multi([["%e",function(a){return 1!=a.getDate()}],["%e %b",function(){return!0}]]),this.timeAxis=d3.svg.axis().scale(a).orient("bottom").ticks(d3.time.days).tickFormat(this.en?b:c)),this.D3svg.append("g").attr({transform:"translate(0, "+this.chartH+")","class":"x-axis"}).call(this.timeAxis);var d=d3.select(".x-axis");if(d.selectAll(".tick > line").style({stroke:"#a1a1a1"}),d.selectAll("text").attr("y",8).attr("x",0).attr("dy","1em").style({"font-size":"10px",fill:"#a1a1a1"}),this.moreThanAMonth||this.moreThanAYear){var e=this.el.querySelectorAll(".tick");this.checkForCutTicksNames(e)}},checkForCutTicksNames:function(a){a[0].getBoundingClientRect().left<=this.el.getBoundingClientRect().left&&(a[0].querySelector("text").style.textAnchor="start",a[0].querySelector("text").setAttribute("x","2")),a[a.length-1].getBoundingClientRect().right>=this.el.getBoundingClientRect().right&&(a[a.length-1].querySelector("text").style.textAnchor="end")},incSvgIfMinusBalance:function(a,b){var c=d3.min(a,function(a){return a.balance});if(0>c){var d=b.balanceYScale(c),e=Math.abs(Math.floor(d));e>this.brushH&&(this.newSVGHeight=this.chartH+e,this.D3svg.attr({height:this.newSVGHeight+"px"}),this.D3leftShadow.attr({height:this.newSVGHeight}),this.D3rightShadow.attr({height:this.newSVGHeight}),this.D3pointerLines.attr({height:this.newSVGHeight}))}},translateTimeTicks:function(a){for(var b=d3.selectAll(".tick")[0],c=/\((.*)[,\.\s]/,d=/\((.*)\)/,e=0,f=b.length;f>e;e++){var g=b[e].getAttribute("transform"),h=+(c.exec(g)||d.exec(g))[1];b[e].setAttribute("transform","translate("+(h+a/2)+", 0)")}},styleChart:function(a,b,c){var d=this.barWidth=this.getBarWidthForADay();this.styleExpense(b,c,d),this.styleDataRects(b,c,d),this.styleBalance(this.balanceData,b,c,d),this.styleRefill(b,c,d)},getBarWidthForADay:function(){var a=this.data[0].date,b=new Date(this.data[0].date.getTime()+864e5);return Math.floor(this.xScale(b)-this.xScale(a))},styleExpense:function(a,b,c){var d=this,e=d3.selectAll("rect.expense"),f=this.chartH;e.attr({x:function(b){return a(b.date)},y:function(a){return f-b.expenseYScale(a.expense)},width:function(b){if(d.moreThanAYear){var e=new Date(b.date.getFullYear(),b.date.getMonth()+1,0);return a(e)-a(b.date)-1+"px"}return(c-1>1?c-1:1)+"px"},height:function(a){return b.expenseYScale(a.expense)}}).style({fill:"#fdd74a","shape-rendering":"crispEdges"})},styleDataRects:function(a,b,c){var d=this,e=d3.selectAll("rect.data"),f=this.chartH;e.attr({x:function(b){return a(b.date)},y:0,width:function(b){if(d.moreThanAYear){var e=new Date(b.date.getFullYear(),b.date.getMonth()+1,0);return a(e)-a(b.date)-1+"px"}return(c>1?c-1:1)+"px"},height:f}).style({"shape-rendering":"crispEdges"})},styleBalance:function(a,b,c,d){var e=this,f=this.chartH;d3.selectAll("rect.balance").attr({x:function(a){if(e.moreThanAYear){var c=new Date(a.date.getFullYear(),a.date.getMonth()+1,0);return b(a.date)+(b(c)-b(a.date))/2}return b(a.date)+d/2},y:function(a){return f-c.balanceYScale(a.balance)},width:"0",height:"0"}).style("fill","#d8dadc");var g=d3.svg.line().x(function(a){return b(a.date)}).y(function(a){return f-c.balanceYScale(a.balance)});g.interpolate("step-after"),d3.select(".balance-line").attr({d:g(a)}).style({stroke:"url(#BalanceGrad)"})},styleRefill:function(a,b,c){var d=this,e=d3.selectAll("circle.refill");e.attr({cx:function(b){if(d.moreThanAYear){var e=new Date(b.date.getFullYear(),b.date.getMonth()+1,0);return a(b.date)+(a(e)-a(b.date)-1)/2}return a(b.date)+c/2},cy:"10px",r:function(a){return b.refillYScale(a.refill)}}).style("fill","#4cbc5b")},addBrush:function(a,b,c,d){var e=0!==this.brushExtent.length?this.brushExtent:[c,d];this.brush=d3.svg.brush().x(a).extent(e).on("brushstart",app.ext.tools.bind(this,this.onbrushStart)).on("brush",app.ext.tools.bind(this,this.onbrush)).on("brushend",app.ext.tools.bind(this,this.onbrushEnd)),this.D3svg.append("g").attr("class","brushG").call(this.brush);var f=d3.select(".brushG");this.addShadowsToTimePointers(f),this.resizeShadows(),this.addTimePointers(),this.showTimePointersIfTheSameDate(e)},addShadowsToTimePointers:function(a){a.insert("rect",".background").attr({"class":"left-shadow",x:0+this.leftIndent,width:0,height:this.svgH}).style({fill:"#f0f0f0",opacity:.4}),a.insert("rect",".extent").attr({"class":"right-shadow",width:0,x:this.chartWrapper.clientWidth+this.leftIndent,height:this.svgH}).style({fill:"#f0f0f0",opacity:.4}),this.D3leftShadow=d3.select(".left-shadow"),this.D3rightShadow=d3.select(".right-shadow"),d3.select(".background").remove(),d3.select(".extent").remove()},resizeShadows:function(){var a=/\((.*)[,\.\s]/,b=/\((.*)\)/,c=this.el.querySelector(".resize.w"),d=this.el.querySelector(".resize.e"),e=c.getAttribute("transform"),f=d.getAttribute("transform"),g=a.exec(e)||b.exec(e),h=a.exec(f)||b.exec(f);this.leftShadowWidth=+g[1]-this.leftIndent,this.rightShadowWidth=this.chartWrapper.clientWidth-+h[1]+this.leftIndent,this.rightShadowXCoord=+h[1],d3.select(".left-shadow").attr({width:this.leftShadowWidth}),d3.select(".right-shadow").attr({x:this.rightShadowXCoord,width:this.rightShadowWidth})},addTimePointers:function(){d3.selectAll("g.resize.w > rect").style("shape-rendering","geometricPrecision").attr({"class":"pointer-line",width:"1px",x:0,height:this.svgH}).style({visibility:"visible",fill:"#aaa"}),d3.selectAll("g.resize.e > rect").attr({"class":"pointer-line",width:"1px",x:-1,height:this.svgH}).style({visibility:"visible",fill:"#aaa"}),this.D3pointerLines=d3.selectAll(".pointer-line");var a=d3.selectAll("g.resize"),b=d3.selectAll("g.resize.e");a.append("circle").style("shape-rendering","geometricPrecision").attr("class","pointer-circle").attr("r",9).attr("cy",this.chartH).attr("transform","translate(0.5, 0)").style("fill","white").style("stroke","#aaa").style("stroke-width","1px").style("shape-rendering","geometricPrecision"),b.select(".pointer-circle").attr("transform","translate(-0.5, 0)"),a.append("path").attr({"class":"pointer-arrows",d:"M10.5,13.5h-1v-7h1V13.5z M5.5,10l2.9,2.9V7.1L5.5,10z M14.5,10l-2.9-2.9v5.9L14.5,10z",transform:"translate(-9.5,"+(this.chartH-10)+")",fill:"#aaa"}),b.select("path").attr("transform","translate(-10.5,"+(this.chartH-10)+")")},showTimePointersIfTheSameDate:function(a){a[0].getTime()===a[1].getTime()&&d3.select(".resize").style({display:"block"})},redrawBrush:function(){d3.select(".brushG").remove(),this.addBrush(this.xScale,this.timeAxis,this.chartDateMin,this.chartDateMax),this.incSvgIfMinusBalance(this.data,this.yScalesObj)},changeChartOnResize:function(a){this.D3svg.attr({width:this.leftIndent+this.chartWrapper.clientWidth+this.rightIndent+"px"}),d3.select(".x-axis").remove(),this.xScale=this.setXScale(a),this.addTimeAxis(this.xScale),this.redrawBrush(),this.styleChart(a,this.xScale,this.yScalesObj)},redrawChart:function(a){this.el.querySelector(".chart_chart-wrapper").innerHTML="",this.el.querySelector(".chart_data-items-wrapper").innerHTML="",this.addSvg(),this.prepareChart(a),this.styleChart(a,this.xScale,this.yScalesObj),this.redrawBrush()},notifyAboutChanges:function(a){function b(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate())}var c=b(a[0]),d=b(a[1]);app.ext.pubsub.fireEvent("period:changed",{period:[c,d]})},getAlertXCoord:function(a){var b=this.el.getBoundingClientRect().left,c=a.clientX;return c-b+this.leftIndent},addAlertIfNotExists:function(a){var b=this.el.querySelector(".chart_alert");if(!b){this.alert=document.createElement("div");var c=this.getAlertXCoord(a);this.alert.className="chart_alert",this.alert.style.left=c-this.leftIndent+"px",this.alert.style.height=this.svgH+"px",this.alert.innerHTML=app.ext.tmp(document.getElementById("Alert").innerHTML)(),this.el.appendChild(this.alert),this.alertContent=this.alert.querySelector(".chart_alert-content")}},removeAlertIfExists:function(){var a=this.el.querySelector(".chart_alert");a&&(a.parentNode.removeChild(a),this.alert=null,this.alertContent=null,this.alertContentReversed=!1)},addDataToAlert:function(a){var b=this.findObjDataToDisplayInAlert(a),c=this.findObjDataToDisplayBalanceInAlert(a),d=this.el.querySelector(".chart_alert-date"),e=this.el.querySelector(".chart_alert-item._expense .chart_alert-item-value"),f=this.el.querySelector(".chart_alert-item._refill .chart_alert-item-value"),g=this.el.querySelector(".chart_alert-item._balance .chart_alert-item-value");this.alert&&(e.innerHTML=this.foundLessDate||"0"==b.expense?"0,00":app.ext.tools.numToStr(b.expense),f.innerHTML=this.foundLessDate||"0"==b.refill?"+0,00":"+"+app.ext.tools.numToStr(b.refill),g.innerHTML=app.ext.tools.numToStr(c.balance)),this.setDateToAlert(d,a)},findObjDataToDisplayInAlert:function(a){this.foundLessDate=!1;for(var b=this.moreThanAYear?new Date(a.getFullYear(),a.getMonth()):new Date(a.getFullYear(),a.getMonth(),a.getDate()),c=this.data.length-1;c>=0;c--){var d=this.moreThanAYear?new Date(this.data[c].date.getFullYear(),this.data[c].date.getMonth()):this.data[c].date;if(d.getTime()===b.getTime())return this.data[c];if(d.getTime()<b.getTime()&&!this.foundLessDate)return this.foundLessDate=!0,this.data[c];if(0===c)return this.data[0]}},findObjDataToDisplayBalanceInAlert:function(a){this.foundLessBalanceDate=!1;for(var b=this.moreThanAYear?new Date(a.getFullYear(),a.getMonth()):new Date(a.getFullYear(),a.getMonth(),a.getDate()),c=this.balanceData.length-1;c>=0;c--){var d=this.moreThanAYear?new Date(this.balanceData[c].date.getFullYear(),this.balanceData[c].date.getMonth()):this.balanceData[c].date;if(d.getTime()===b.getTime())return this.balanceData[c];if(d.getTime()<b.getTime()&&!this.foundLessBalanceDate)return this.foundLessBalanceDate=!0,this.balanceData[c];if(0===c)return this.balanceData[0]}},setDateToAlert:function(a,b){b.getTime()<this.dateMin.getTime()&&(b=this.dateMin),b.getTime()>this.dateMax.getTime()&&(b=this.dateMax);var c,d=app.ext.tools.dateToStr(b,"."),e=app.ext.tools[this.en?"monthWordHashEn":"monthWordHash2"],f=d.split(".");c=this.moreThanAYear?e[f[1]]+" "+f[2]:app.ext.tools.dateStrToStrWithFullMonth(d,this.en?"en":"ru"),a&&(a.innerHTML=c)},handleResizeMouseover:function(a){var b=document.elementFromPoint(a.clientX,a.clientY);"pointer-circle"===b.getAttribute("class")||"pointer-arrows"===b.getAttribute("class")?(this.enteredResizeEl=!0,this.removeAlertIfExists()):(this.enteredResizeEl=!1,this.addAlertIfNotExists(a))},handleAlertPresence:function(a,b){this.enteredResizeEl||(b.getTime()<this.chartDateMin.getTime()||b.getTime()>this.chartDateMax.getTime()?this.removeAlertIfExists():this.addAlertIfNotExists(a))},handleAlertContentDirection:function(){if(this.alert){var a=this.alert.getBoundingClientRect().right+this.alertContent.offsetWidth,b=this.el.getBoundingClientRect().right;a>=b?this.alertContentReversed||(this.alertContent.classList.add("_reverse"),this.alertContentReversed=!0):this.alertContentReversed&&(this.alertContent.classList.remove("_reverse"),this.alertContentReversed=!1)}},bindEvents:function(){app.ext.tools.addListener(this.el,"mousemove",app.ext.tools.bind(this,this.onmousemoveChart)),app.ext.tools.addListener(this.el,"mouseleave",app.ext.tools.bind(this,this.onmouseleaveChart)),app.ext.tools.addListener(window,"resize",app.ext.tools.bind(this,this.onresize)),app.ext.pubsub.addListener("cardsFilter:changed",app.ext.tools.bind(this,this.onCardsFilterChange)),app.ext.pubsub.addListener("chart-pointers:move",app.ext.tools.bind(this,this.onPeriodChange))},onmouseoverChart:function(a){if(a.target.classList.contains("data"))this.dataEl=a.target,this.dataEl.classList.add("-hovered");else if(a.target.classList.contains("expense")||a.target.classList.contains("refill"))for(var b=0,c=this.dataRects.length;c>b;b++)this.dataRects[b].__data__.date.getTime()===a.target.__data__.date.getTime()&&(this.dataEl=this.dataRects[b],this.dataEl.classList.add("-hovered"))},onmouseoutChart:function(a){(a.target.classList.contains("data")||a.target.classList.contains("expense")||a.target.classList.contains("refill"))&&this.dataEl&&(this.dataEl.classList.remove("-hovered"),this.dataEl=null)},onmouseleaveChart:function(){this.removeAlertIfExists()},onmousemoveChart:function(a){if(this.brushing||app.historyDropdownOpened)return!1;var b=this.getAlertXCoord(a),c=this.xScale.invert(b);this.handleResizeMouseover(a),this.handleAlertPresence(a,c),this.addDataToAlert(c),this.handleAlertContentDirection(),this.alert&&(this.alert.style.left=b-this.leftIndent+"px")},onresize:function(){this.changeChartOnResize(this.data)},onbrush:function(){this.removeAlertIfExists();var a=this.brush.extent();a[0].getTime()<this.dateMin.getTime()&&(a[0]=this.dateMin),a[1].getTime()>this.dateMax.getTime()&&(a[1]=this.dateMax),app.ext.pubsub.fireEvent("chart-pointers:moved",{period:a}),this.resizeShadows()},onbrushStart:function(){this.brushing=!0},onbrushEnd:function(){this.brushing=!1,this.brushExtent=this.brush.extent(),this.showTimePointersIfTheSameDate(this.brushExtent),this.notifyAboutChanges(this.brushExtent)},onCardsFilterChange:function(a){this.filters.cards=a.cards,this.prepareFilteredData(this.parent.jsonData),this.redrawChart(this.data)},onPeriodChange:function(a){var b=a.period;a.dateMin&&(b[0]=this.chartDateMin),a.dateMax&&(b[1]=this.chartDateMax),this.brushExtent=b,this.redrawBrush()}},{init:function(){var b=document.querySelector(".b-chart");
null!==b&&(app.module.chart=new a({el:b,parent:app.module.history}))}}}),app.register("module","period",function(){function a(a){this.el=a.el,this.parent=a.parent,this.en=app.en,this.startEl=document.getElementById("StartPeriodItem"),this.endEl=document.getElementById("EndPeriodItem"),this.initialize()}return a.prototype={constructor:a,initialize:function(){this.setMinMaxDates(),this.setDatesToDatepickers(),this.bindEvents()},setMinMaxDates:function(){this.startEl.innerHTML=this.getDateStrWithFullMonth(app.periodStartDate),this.endEl.innerHTML=this.getDateStrWithFullMonth(app.periodEndDate),this.dateMin=app.ext.tools.dateToStr(app.periodStartDate,"."),this.dateMax=app.ext.tools.dateToStr(app.periodEndDate,".")},setDatesToDatepickers:function(){this.startDatepicker=this.startEl.parentNode.querySelector(".b-datepicker"),this.startDatepicker.setAttribute("data-min",this.dateMin),this.startDatepicker.setAttribute("data-max",this.dateMax),this.endDatepicker=this.endEl.parentNode.querySelector(".b-datepicker"),this.endDatepicker.setAttribute("data-max",this.dateMax),this.endDatepicker.setAttribute("data-min",this.dateMin)},notifyAboutChanges:function(){var a=this.turnNullBackToDate(this.startEl.innerHTML),b=this.turnNullBackToDate(this.endEl.innerHTML),c=this.en?app.ext.tools.strWithFullMonthToDate(a,"en"):app.ext.tools.strWithFullMonthToDate(a,"ru"),d=this.en?app.ext.tools.strWithFullMonthToDate(b,"en"):app.ext.tools.strWithFullMonthToDate(b,"ru"),e=c.getTime()===app.ext.tools.strToDate(this.dateMin,".").getTime(),f=d.getTime()===app.ext.tools.strToDate(this.dateMax,".").getTime();app.ext.pubsub.fireEvent("period:changed",{period:[c,d]}),app.ext.pubsub.fireEvent("chart-pointers:move",{period:[c,d],dateMin:e,dateMax:f})},getDateStrWithFullMonth:function(a){"string"!=typeof a&&(a=app.ext.tools.dateToStr(a,"."));var b=this.en?app.ext.tools.dateStrToStrWithFullMonth(a,"en"):app.ext.tools.dateStrToStrWithFullMonth(a,"ru");return"0"===b.charAt(0)&&(b=b.slice(1)),b},turnNullBackToDate:function(a){var b=a.split(" ");return 1===b[0].length&&(a="0"+a),a},bindEvents:function(){app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickItem)),app.ext.tools.addListener(app.el,"click",app.ext.tools.bind(this,this.hideDatepickers)),app.ext.pubsub.addListener("date:"+this.startEl.id+":changed",app.ext.tools.bind(this,this.onStartDateChange)),app.ext.pubsub.addListener("date:"+this.endEl.id+":changed",app.ext.tools.bind(this,this.onEndDateChange)),app.ext.pubsub.addListener("chart-pointers:moved",app.ext.tools.bind(this,this.onPointersMoved)),app.ext.pubsub.addListener("datepicker:hidden",app.ext.tools.bind(this,this.onDatepickerHidden)),app.ext.pubsub.addListener("datepicker:shown",app.ext.tools.bind(this,this.onDatepickerShown))},onclickItem:function(a){var b=a||window.event,c=b.target||b.srcElement;if(c.classList.contains("period_item-name")){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0;var d=this.turnNullBackToDate(c.innerHTML),e=this.en?app.ext.tools.strWithFullMonthToDateStr(d,"en"):app.ext.tools.strWithFullMonthToDateStr(d,"ru");app.ext.pubsub.fireEvent("datepicker:"+c.id+":show",{date:e})}},hideDatepickers:function(){app.ext.pubsub.fireEvent("datepicker:"+this.startEl.id+":hide"),app.ext.pubsub.fireEvent("datepicker:"+this.endEl.id+":hide")},onStartDateChange:function(a){this.startEl.innerHTML=this.getDateStrWithFullMonth(a.dateStr),this.startEl.classList.remove("-active"),this.endDatepicker.setAttribute("data-min",a.dateStr),this.notifyAboutChanges()},onEndDateChange:function(a){this.endEl.innerHTML=this.getDateStrWithFullMonth(a.dateStr),this.endEl.classList.remove("-active"),this.startDatepicker.setAttribute("data-max",a.dateStr),this.notifyAboutChanges()},onPointersMoved:function(a){var b=app.ext.tools.dateToStr(a.period[0],"."),c=app.ext.tools.dateToStr(a.period[1],".");this.startEl.innerHTML=this.getDateStrWithFullMonth(b),this.endEl.innerHTML=this.getDateStrWithFullMonth(c),this.endDatepicker.setAttribute("data-min",b),this.startDatepicker.setAttribute("data-max",c)},onDatepickerHidden:function(a){document.getElementById(a.elId).classList.remove("-active")},onDatepickerShown:function(a){document.getElementById(a.elId).classList.add("-active")}},{init:function(){var b=document.querySelector(".b-period");null!==b&&(app.module.period=new a({el:b,parent:app.module.history}))}}}),app.register("module","shortcuts",function(){function a(a){this.el=a.el,this.parent=a.parent,this.en=app.en,this.maxFrnCountries=5,this.activeShortcuts=[],this.initialize()}return a.prototype={constructor:a,initialize:function(){this.shortcutsList=this.defaultShortcutsList=this.getShortcutsList(this.parent.jsonData),this.drawShortcuts(this.shortcutsList),this.bindEvents()},getShortcutsList:function(a){var b=[],c=this.checkForCurrencyShortcutAr(a);if(0!==c.length&&b.push({name:-1!==app.cur.indexOf("ru")?this.en?"In foreign currency":"В иностранной валюте":this.en?"Not in the account currency":"Не в валюте счета",value:c}),this.parent.jsonData>=30){var d=this.checkForBigSumShortcutAr(a);0!==d.length&&b.push({name:this.en?"Large transactions":"Крупные операции",value:d})}for(var e=this.getFrnCountries(a),f=0,g=e.length;g>f;f++)b.push({name:e[f].name,value:e[f].value});return b},checkForCurrencyShortcutAr:function(a){for(var b=[],c=0,d=a.length;d>c;c++)""!==a[c].frnCur&&b.push(a[c].id);return b},checkForBigSumShortcutAr:function(a){var b=this.getMaxTrSum(this.parent.jsonData);return this.getBigSumsTrsId(b,a)},getMaxTrSum:function(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(app.ext.tools.strToNum(a[c].cardSum));return b.sort(function(a,b){return b-a}),b[0]},getBigSumsTrsId:function(a,b){for(var c=[],d=0,e=b.length;e>d;d++){var f=app.ext.tools.strToNum(b[d].cardSum);f>=.9*a&&c.push(b[d].id)}return c},getFrnCountries:function(a){for(var b={},c=[],d=0,e=a.length;e>d;d++)"rus"!==a[d].country.toLowerCase()&&(b[a[d].country]?b[a[d].country].push(a[d].id):(b[a[d].country]=[],b[a[d].country].push(a[d].id)));for(var f in b)if(b.hasOwnProperty(f)){var g=app.countries[f]?app.countries[f][0]:f;c.push({name:g,value:b[f]})}if(c.length>this.maxFrnCountries){for(var h=[],i=0,j=c.length;j>i;i++)h=h.concat(c[i].value);return[{name:this.en?"Abroad":"Зарубежом",value:h}]}return c},drawShortcuts:function(a){if(this.el.innerHTML="",0===a.length)return!1;var b=document.createElement("div");b.className="shortcuts_title",b.innerHTML=this.en?"For example":"Например:";var c=document.createElement("ul");c.className="shortcuts_ul";for(var d="",e=0,f=a.length;f>e;e++)d+=app.ext.tmp(document.getElementById("ShortcutsItem").innerHTML)(a[e]);c.innerHTML=d,this.el.appendChild(b),this.el.appendChild(c)},setShortcutsFilter:function(){if(0===this.activeShortcuts.length)return[];for(var a=[],b=[],c=0,d=this.activeShortcuts.length;d>c;c++)for(var e=0,f=this.defaultShortcutsList.length;f>e;e++)this.defaultShortcutsList[e].name===this.activeShortcuts[c]&&(a=a.concat(this.defaultShortcutsList[e].value));for(var g={},h=0,i=a.length;i>h;h++)g[a[h]]?g[a[h]]++:g[a[h]]=1;for(var j in g)g.hasOwnProperty(j)&&g[j]===this.activeShortcuts.length&&b.push(j);return b},removeFromActiveShortcutsList:function(a){var b=[];a:for(var c=0,d=this.activeShortcuts.length;d>c;c++)for(var e=0,f=a.length;f>e;e++){if(this.activeShortcuts[c]===a[e])continue a;e===f-1&&b.push(this.activeShortcuts[c])}return b},notifyAboutChanges:function(){var a=this.setShortcutsFilter();app.ext.pubsub.fireEvent("shortcuts:changed",{filter:a})},bindEvents:function(){app.ext.tools.addListener(this.el,"click",app.ext.tools.bind(this,this.onclickShortcut)),app.ext.pubsub.addListener("shortcuts:remove",app.ext.tools.bind(this,this.onRemoveShortcuts)),app.ext.pubsub.addListener("shortcuts:redraw",app.ext.tools.bind(this,this.onRedrawShortcuts))},onclickShortcut:function(a){var b=a||window.event,c=b.target||b.srcElement;if(c.classList.contains("shortcuts_link")){b.preventDefault?b.preventDefault():b.returnValue=!1;var d=app.ext.tools.trim(c.innerHTML);this.activeShortcuts.push(d),app.ext.pubsub.fireEvent("search:add-shortcut",{name:d}),this.notifyAboutChanges()}},onRemoveShortcuts:function(a){var b=a.shortcutsNames;0!==b.length&&(this.activeShortcuts=this.removeFromActiveShortcutsList(b)),this.notifyAboutChanges()},onRedrawShortcuts:function(a){var b,c=a.data;this.shortcutsList=this.getShortcutsList(c),b=0!==this.activeShortcuts.length?this.sliceListIfActiveShortcutsExist(this.shortcutsList):this.shortcutsList,this.drawShortcuts(b)},sliceListIfActiveShortcutsExist:function(a){var b=[];a:for(var c=0,d=a.length;d>c;c++)for(var e=0,f=this.activeShortcuts.length;f>e;e++){if(a[c].name===this.activeShortcuts[e])continue a;e==f-1&&b.push(a[c])}return b}},{init:function(){var b=document.querySelector(".b-shortcuts");null!==b&&(app.module.trs=new a({el:b,parent:app.module.history}))}}}),app.en=app.el.classList.contains("_en"),app.periodStartDate=app.ext.tools.strToDate(document.getElementById("ReportPeriodStart").innerHTML,"."),app.periodEndDate=app.ext.tools.strToDate(document.getElementById("ReportPeriodEnd").innerHTML,"."),app.balanceStartNum=app.ext.tools.strToNum(app.el.querySelector("#BalanceStartNum").innerHTML),app.start({ext:"browser-type"}),app.start({ext:"pubsub"}),app.start({ext:"tools"}),app.start({ext:"tmp"}),app.start({ui:"datepicker"}),app.start({module:"title"}),app.start({module:"main"}),app.start({module:"card-opers"}),app.start({module:"state"}),app.start({module:"balance"}),app.start({module:"past-period"}),app.start({module:"card"}),app.start({module:"extra-cards"}),app.start({module:"extra-card"}),app.start({module:"card-info"}),app.start({module:"history"}),app.start({module:"categories"}),app.start({module:"search"}),app.start({module:"trs"}),app.start({module:"cards-filter"}),app.start({module:"period"}),app.start({module:"shortcuts"}),!app.ext["browser-type"].ie8&&window.d3&&app.start({module:"chart"}),app.ext["browser-type"].ie8&&app.start({ext:"mediaIE8"}),app.bindEvents();